<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>20.5. 描画</title>
<link rel="stylesheet" href="dbstyle.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.69.1">
<link rel="start" href="index.html" title="プログラマ向けリファレンスガイド">
<link rel="up" href="zend.pdf.html" title="第20章 Zend_Pdf">
<link rel="prev" href="zend.pdf.pages.html" title="20.4. ドキュメントのページ">
<link rel="next" href="zend.pdf.usage.html" title="20.6. Zend_Pdf モジュールの使用例">
<link rel="chapter" href="zend.html" title="第1章 Zend">
<link rel="chapter" href="zend.acl.html" title="第2章 Zend_Acl">
<link rel="chapter" href="zend.auth.html" title="第3章 Zend_Auth">
<link rel="chapter" href="zend.cache.html" title="第4章 Zend_Cache">
<link rel="chapter" href="zend.config.html" title="第5章 Zend_Config">
<link rel="chapter" href="zend.console.getopt.html" title="第6章 Zend_Console_Getopt">
<link rel="chapter" href="zend.controller.html" title="第7章 Zend_Controller">
<link rel="chapter" href="zend.date.html" title="第8章 Zend_Date">
<link rel="chapter" href="zend.db.html" title="第9章 Zend_Db">
<link rel="chapter" href="zend.feed.html" title="第10章 Zend_Feed">
<link rel="chapter" href="zend.filter.html" title="第11章 Zend_Filter">
<link rel="chapter" href="zend.gdata.html" title="第12章 Zend_Gdata">
<link rel="chapter" href="zend.http.html" title="第13章 Zend_Http">
<link rel="chapter" href="zend.json.html" title="第14章 Zend_Json">
<link rel="chapter" href="zend.locale.html" title="第15章 Zend_Locale">
<link rel="chapter" href="zend.log.html" title="第16章 Zend_Log">
<link rel="chapter" href="zend.mail.html" title="第17章 Zend_Mail">
<link rel="chapter" href="zend.measure.html" title="第18章 Zend_Measure">
<link rel="chapter" href="zend.mime.html" title="第19章 Zend_Mime">
<link rel="chapter" href="zend.pdf.html" title="第20章 Zend_Pdf">
<link rel="chapter" href="zend.rest.html" title="第21章 Zend_Rest">
<link rel="chapter" href="zend.search.html" title="第22章 Zend_Search">
<link rel="chapter" href="zend.server.html" title="第23章 Zend_Server">
<link rel="chapter" href="zend.service.html" title="第24章 Zend_Service">
<link rel="chapter" href="zend.session.html" title="第25章 Zend_Session">
<link rel="chapter" href="zend.uri.html" title="第26章 Zend_Uri">
<link rel="chapter" href="zend.validate.html" title="第27章 Zend_Validate">
<link rel="chapter" href="zend.view.html" title="第28章 Zend_View">
<link rel="chapter" href="zend.xmlrpc.html" title="第29章 Zend_XmlRpc">
<link rel="appendix" href="coding-standard.html" title="付録 A. Zend Framework PHP 標準コーディング規約">
<link rel="appendix" href="copyrights.html" title="付録 B. 著作権に関する情報">
<link rel="index" href="the.index.html" title="目次">
<link rel="subsection" href="zend.pdf.drawing.html#zend.pdf.drawing.geometry" title="20.5.1. ジオメトリ">
<link rel="subsection" href="zend.pdf.drawing.html#zend.pdf.drawing.color" title="20.5.2. 色">
<link rel="subsection" href="zend.pdf.drawing.html#zend.pdf.drawing.shape-drawing" title="20.5.3. 図形の描画">
<link rel="subsection" href="zend.pdf.drawing.html#zend.pdf.drawing.text-drawing" title="20.5.4. テキストの描画">
<link rel="subsection" href="zend.pdf.drawing.html#zend.pdf.drawing.using-fonts" title="20.5.5. フォントの使用">
<link rel="subsection" href="zend.pdf.drawing.html#zend.pdf.drawing.image-drawing" title="20.5.6. 画像の描画">
<link rel="subsection" href="zend.pdf.drawing.html#zend.pdf.drawing.line-drawing-style" title="20.5.7. 直線の描画スタイル">
<link rel="subsection" href="zend.pdf.drawing.html#zend.pdf.drawing.fill-style" title="20.5.8. 塗りつぶしのスタイル">
<link rel="subsection" href="zend.pdf.drawing.html#zend.pdf.drawing.rotations" title="20.5.9. 回転">
<link rel="subsection" href="zend.pdf.drawing.html#zend.pdf.drawing.save-restore" title="20.5.10. グラフィックの状態の保存/復元">
<link rel="subsection" href="zend.pdf.drawing.html#zend.pdf.drawing.clipping" title="20.5.11. 描画領域のクリッピング">
<link rel="subsection" href="zend.pdf.drawing.html#zend.pdf.drawing.styles" title="20.5.12. スタイル">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader"><table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">20.5. 描画</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="zend.pdf.pages.html">前のページ</a> </td>
<th width="60%" align="center">第20章 Zend_Pdf</th>
<td width="20%" align="right"> <a accesskey="n" href="zend.pdf.usage.html">次のページ</a>
</td>
</tr>
</table></div>
<div class="sect1" lang="ja">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="zend.pdf.drawing"></a>20.5. 描画</h2></div></div></div>
<div class="sect2" lang="ja">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.pdf.drawing.geometry"></a>20.5.1. ジオメトリ</h3></div></div></div>
<p>
        PDF は PostScript と同じジオメトリを使用します。ページの左下隅を基準とし、
        デフォルトではポイント数 (1 インチの 1/72) で場所を指定します。
        </p>
<p>
        ページの大きさはページオブジェクトから取得できます。
        </p>
<p>
            </p>
<pre class="programlisting">
$width  = $pdfPage-&gt;getWidth();
$height = $pdfPage-&gt;getHeight();
            </pre>
<p>
        </p>
</div>
<div class="sect2" lang="ja">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.pdf.drawing.color"></a>20.5.2. 色</h3></div></div></div>
<p>
        PDF には、色を表現するためのさまざまな方法があります。Zend_Pdf では、
        グレイスケール、RGB および CMYK 色空間をサポートしています。
        <code class="code">Zend_Pdf_Color</code> オブジェクトが要求される箇所では、
        これらのどれでも使用することができます。それぞれの色空間に対応する機能を提供するのが
        <code class="code">Zend_Pdf_Color_GrayScale</code>、<code class="code">Zend_Pdf_Color_RGB</code> および
        <code class="code">Zend_Pdf_Color_CMYK</code> クラスです。
        </p>
<pre class="programlisting">
// $grayLevel (float 型の数値)。0.0 (黒) - 1.0 (白)
$color1 = new Zend_Pdf_Color_GrayScale($grayLevel);

// $r, $g, $b (float 型の数値)。0.0 (最低の強度) - 1.0 (最大の強度)
$color2 = new Zend_Pdf_Color_RGB($r, $g, $b);

// $c, $m, $y, $k (float 型の数値)。0.0 (最小の強度) - 1.0 (最大の強度)
$color3 = new Zend_Pdf_Color_CMYK($c, $m, $y, $k);
        </pre>
</div>
<div class="sect2" lang="ja">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.pdf.drawing.shape-drawing"></a>20.5.3. 図形の描画</h3></div></div></div>
<p>
        描画操作は、PDF のページに対して行われます。
        </p>
<p>
        基本図形のセットが <code class="code">Zend_Pdf_Page</code> クラスで提供されています。
        </p>
<pre class="programlisting">
/**
 * x1,y1 から x2,y2 まで直線を描画します。
 *
 * @param float $x1
 * @param float $y1
 * @param float $x2
 * @param float $y2
 */
public function drawLine($x1, $y1, $x2, $y2);
        </pre>
<pre class="programlisting">
/**
 * 矩形を描画します。
 *
 * 描画方法
 * Zend_Pdf_Page::SHAPE_DRAW_FILL_AND_STROKE - 輪郭を描画して塗りつぶします (デフォルト)
 * Zend_Pdf_Page::SHAPE_DRAW_STROKE      - 輪郭を描画します
 * Zend_Pdf_Page::SHAPE_DRAW_FILL        - 矩形を塗りつぶします
 *
 * @param float $x1
 * @param float $y1
 * @param float $x2
 * @param float $y2
 * @param integer $fillType
 */
public function drawRectangle($x1, $y1, $x2, $y2, $fillType = Zend_Pdf_Page::SHAPE_DRAW_FILL_AND_STROKE);
        </pre>
<pre class="programlisting">
/**
 * 多角形を描画します。
 *
 * $fillType が Zend_Pdf_Page::SHAPE_DRAW_FILL_AND_STROKE あるいは Zend_Pdf_Page::SHAPE_DRAW_FILL
 * の場合、多角形は自動的に閉じられます。このメソッドについての詳細は、
 * PDF のドキュメント (section 4.4.2 Path painting Operators, Filling)
 * を参照ください。
 *
 * @param array $x  - float の配列 (頂点の X 座標)
 * @param array $y  - float の配列 (頂点の Y 座標)
 * @param integer $fillType
 * @param integer $fillMethod
 */
public function drawPolygon($x, $y,
                            $fillType = Zend_Pdf_Page::SHAPE_DRAW_FILL_AND_STROKE,
                            $fillMethod = Zend_Pdf_Page::FILL_METHOD_NON_ZERO_WINDING);
        </pre>
<pre class="programlisting">
/**
 * 中心が x, y で半径が radius の円を描画します。
 *
 * 角度はラジアンで指定します。
 *
 * Method signatures:
 * drawCircle($x, $y, $radius);
 * drawCircle($x, $y, $radius, $fillType);
 * drawCircle($x, $y, $radius, $startAngle, $endAngle);
 * drawCircle($x, $y, $radius, $startAngle, $endAngle, $fillType);
 *
 *
 * これは本当の円ではありません。PDF は 3 次ベジエ曲線しかサポートしていないからです。
 * とはいえ、本当の円にかなり近くなります。
 * 本当の円との誤差は、最大でも半径の 0.00026 倍にしかなりません
 * (角度が PI/8, 3*PI/8, 5*PI/8, 7*PI/8, 9*PI/8, 11*PI/8, 13*PI/8 そして 15*PI/8 の場合)。
 * 0, PI/4, PI/2, 3*PI/4, PI, 5*PI/4, 3*PI/2 そして 7*PI/4 の場合は、円の正確な接線となります。
 *
 * @param float $x
 * @param float $y
 * @param float $radius
 * @param mixed $param4
 * @param mixed $param5
 * @param mixed $param6
 */
public function  drawCircle($x, $y, $radius, $param4 = null, $param5 = null, $param6 = null);
        </pre>
<pre class="programlisting">
/**
 * 指定した矩形に内接する楕円を描画します。
 *
 * Method signatures:
 * drawEllipse($x1, $y1, $x2, $y2);
 * drawEllipse($x1, $y1, $x2, $y2, $fillType);
 * drawEllipse($x1, $y1, $x2, $y2, $startAngle, $endAngle);
 * drawEllipse($x1, $y1, $x2, $y2, $startAngle, $endAngle, $fillType);
 *
 * 角度はラジアンで指定します。
 *
 * @param float $x1
 * @param float $y1
 * @param float $x2
 * @param float $y2
 * @param mixed $param5
 * @param mixed $param6
 * @param mixed $param7
 */
public function drawEllipse($x1, $y1, $x2, $y2, $param5 = null, $param6 = null, $param7 = null);
        </pre>
</div>
<div class="sect2" lang="ja">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.pdf.drawing.text-drawing"></a>20.5.4. テキストの描画</h3></div></div></div>
<p>
        テキストに対する描画操作も、PDF のページに対して行われます。
        ベースラインの x 座標および y 座標を指定することで、
        ページ内の任意の場所にテキストを 1 行描画することができます。
        現在のフォントおよびフォントサイズを使用して、描画操作が行われます
        (詳細は、以下を参照ください)。
        </p>
<pre class="programlisting">
/**
 * 指定した位置にテキストを描画します。
 *
 * @param string $text
 * @param float $x
 * @param float $y
 * @param string $charEncoding (オプション) ソーステキストの文字エンコーディング。
 *   デフォルトは現在のロケールです。
 * @throws Zend_Pdf_Exception
 */
public function drawText($text, $x, $y, $charEncoding = '');
        </pre>
<div class="example">
<a name="id4871587"></a><p class="title"><b>例 20.5. ページ上への文字列の描画</b></p>
<pre class="programlisting">&lt;?php
...
$pdfPage-&gt;drawText('Hello world!', 72, 720);
...
?&gt;
            </pre>
</div>
<p>
        デフォルトでは、現在のロケールのエンコーディングによって
        テキストの文字列が解釈されます。異なるエンコーディングを使用している場合
        (例えば、ディスク上のファイルから UTF-8 の文字列を読み込んだり
        レガシーなデータベースから MacRoman の文字列を取得したりなど) は、
        描画の際に文字エンコーディングを指定することができます。
        そうすることで、Zend_Pdf が変換処理を行います。PHP の
        <code class="code"><a href="http://www.php.net/manual/function.iconv.php" target="_top">iconv()</a></code>
        関数がサポートしているエンコーディングなら、すべて入力として使用することが可能です。
        </p>
<div class="example">
<a name="id4871646"></a><p class="title"><b>例 20.6. UTF-8 でエンコードされた文字列をページに描画する</b></p>
<pre class="programlisting">&lt;?php
...
// UTF-8 エンコードされた文字列をディスクから読み込みます
$unicodeString = fread($fp, 1024);

// 文字列をページ上に描画します
$pdfPage-&gt;drawText($unicodeString, 72, 720, 'UTF-8');
...
?&gt;
            </pre>
</div>
</div>
<div class="sect2" lang="ja">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.pdf.drawing.using-fonts"></a>20.5.5. フォントの使用</h3></div></div></div>
<p>
        <code class="code">Zend_Pdf_Page::drawText()</code> は、
        現在設定されているフォントおよびフォントサイズを使用します。
        これは <code class="code">Zend_Pdf_Page::setFont()</code> メソッドで設定できます。
        </p>
<pre class="programlisting">
/**
 * 現在のフォントを設定します。
 *
 * @param Zend_Pdf_Resource_Font $font
 * @param float $fontSize
 */
public function setFont(Zend_Pdf_Font $font, $fontSize);
        </pre>
<p>
        PDF ドキュメントは、PostScript Type 1 フォントおよび TrueType フォントだけでなく、
        PDF 用の特別な形式である Type 3 フォントや複合フォントもサポートしています。
        すべての PDF ビューアには、以下の 14 種類の標準 Type 1 フォントが組み込まれています。
        その内容は Courier (4 種類)、Helvetica (4 種類)、Times (4 種類)、Symbol
        そして Zapf Dingbats です。
        </p>
<p>
        現在 Zend_Pdf は、標準の 14 種類の PDF フォントだけでなく
        独自の TrueType フォントもサポートしています。フォントオブジェクトを取得するには、
        2 種類のファクトリーメソッドのいずれかを使用します。使用するメソッドは、
        標準の 14 種類の PDF フォントの場合は <code class="code">Zend_Pdf_Font::fontWithName($fontName)</code>、
        独自のフォントの場合は <code class="code">Zend_Pdf_Font::fontWithPath($filePath)</code> です。
        </p>
<div class="example">
<a name="id4871750"></a><p class="title"><b>例 20.7. 標準フォントの作成</b></p>
<pre class="programlisting">&lt;?php
...
// 新しいフォントを作成します。
$font = Zend_Pdf_Font::fontWithName(Zend_Pdf_Font::FONT_HELVETICA);

// フォントを適用します。
$pdfPage-&gt;setFont($font, 36);
...
?&gt;
            </pre>
</div>
<p>
        14 種類の標準フォント名を表す定数は、<code class="code">Zend_Pdf_Font</code> クラスで定義されています。
        </p>
<div class="itemizedlist"><ul type="disc">
<li><p>Zend_Pdf_Font::FONT_COURIER</p></li>
<li><p>Zend_Pdf_Font::FONT_COURIER_BOLD</p></li>
<li><p>Zend_Pdf_Font::FONT_COURIER_ITALIC</p></li>
<li><p>Zend_Pdf_Font::FONT_COURIER_BOLD_ITALIC</p></li>
<li><p>Zend_Pdf_Font::FONT_TIMES</p></li>
<li><p>Zend_Pdf_Font::FONT_TIMES_BOLD</p></li>
<li><p>Zend_Pdf_Font::FONT_TIMES_ITALIC</p></li>
<li><p>Zend_Pdf_Font::FONT_TIMES_BOLD_ITALIC</p></li>
<li><p>Zend_Pdf_Font::FONT_HELVETICA</p></li>
<li><p>Zend_Pdf_Font::FONT_HELVETICA_BOLD</p></li>
<li><p>Zend_Pdf_Font::FONT_HELVETICA_ITALIC</p></li>
<li><p>Zend_Pdf_Font::FONT_HELVETICA_BOLD_ITALIC</p></li>
<li><p>Zend_Pdf_Font::FONT_SYMBOL</p></li>
<li><p>Zend_Pdf_Font::FONT_ZAPFDINGBATS</p></li>
</ul></div>
<p>
        </p>
<p>
        任意の TrueType フォント (通常は '.ttf' という拡張子です) も使用できますし、
        TrueType アウトラインを含む OpenType フォント (拡張子は '.otf')
        を使用することも可能です。現在はまだサポートしていませんが、将来は
        Mac OS X の .dfont ファイルや Microsoft TrueType Collection
        (拡張子 '.ttc') ファイルもサポートする予定です。
        </p>
<p>
        TrueType フォントを使用するには、フォントへのフルパスを指定しなければなりません。
        何らかの理由でフォントが読み込めなかった場合、あるいはそれが TrueType
        フォントでなかった場合は、ファクトリーメソッドが例外をスローします。
        </p>
<div class="example">
<a name="id4871912"></a><p class="title"><b>例 20.8. TrueType フォントの作成</b></p>
<pre class="programlisting">&lt;?php
...
// 新しいフォントを作成します
$goodDogCoolFont = Zend_Pdf_Font::fontWithPath('/path/to/GOODDC__.TTF');

// フォントを適用します
$pdfPage-&gt;setFont($goodDogCoolFont, 36);
...
?&gt;
            </pre>
</div>
<p>
        デフォルトでは、独自のフォントは PDF ドキュメントに埋め込まれます。
        そのため、閲覧者のシステムにそのフォントがインストールされていなくても、
        ページをきちんと閲覧できるようになります。ファイルの大きさが気になる場合は、
        ファクトリーメソッドのオプションで「フォントを埋め込まない」ことを指定することができます。
        </p>
<div class="example">
<a name="id4871930"></a><p class="title"><b>例 20.9. TrueType を作成するが、PDF ドキュメントには埋め込まない</b></p>
<pre class="programlisting">&lt;?php
...
// 新しいフォントを作成します
$goodDogCoolFont = Zend_Pdf_Font::fontWithPath('/path/to/GOODDC__.TTF',
                                               Zend_Pdf_Font::EMBED_DONT_EMBED);

// フォントを適用します
$pdfPage-&gt;setFont($goodDogCoolFont, 36);
...
?&gt;
            </pre>
</div>
<p>
        PDF ファイルにフォントが埋め込まれていないけれども
        閲覧者のシステムにはそのフォントがインストールされている場合は、ドキュメントは通常通りに閲覧できます。
        もし適切なフォントがインストールされていないは、PDF 閲覧アプリケーションが適切な代替フォントを選択します。
        </p>
<p>
        中には、PDF ドキュメントへの埋め込みを禁止するようなライセンスを使用しているフォントもあります。
        これをあなどってはいけません。もし埋め込めないフォントを利用しようとすると、
        ファクトリーメソッドは例外をスローします。
        </p>
<p>
        このようなフォントを使用することも可能ですが、そのためには、
        上で説明した「埋め込まない」フラグを使用するか、あるいは例外を抑制しなければなりません。
        </p>
<div class="example">
<a name="id4872015"></a><p class="title"><b>例 20.10. 埋め込みが禁止されているフォントで、例外をスローさせないようにする</b></p>
<pre class="programlisting">&lt;?php
...
$font = Zend_Pdf_Font::fontWithPath('/path/to/unEmbeddableFont.ttf',
                                    Zend_Pdf_Font::EMBED_SUPPRESS_EMBED_EXCEPTION);
...
?&gt;
            </pre>
</div>
<p>
        利用者にフォントを選択させる場合などは、この抑制方法を使用することをお勧めします。
        PDF ドキュメントに埋め込めるフォントなら埋め込むでしょうし、
        埋め込めないフォントは埋め込まないでしょう。
        </p>
<p>
        フォントのサイズは比較的大きく、中には 10 メガバイトに達するものもあります。
        デフォルトでは埋め込みフォントは Flate 圧縮され、平均して 50% ほどサイズを節約できます。
        何らかの理由でフォントを圧縮したくない場合は、以下のオプションで圧縮を無効にすることができます。
        </p>
<div class="example">
<a name="id4872064"></a><p class="title"><b>例 20.11. 埋め込みフォントを圧縮しない</b></p>
<pre class="programlisting">&lt;?php
...
$font = Zend_Pdf_Font::fontWithPath('/path/to/someReallyBigFont.ttf',
                                    Zend_Pdf_Font::EMBED_DONT_COMPRESS);
...
?&gt;
            </pre>
</div>
<p>
        最後に、必要に応じていくつかの埋め込みオプションをビット OR 演算子で連結することもできます。
        </p>
<div class="example">
<a name="id4872094"></a><p class="title"><b>例 20.12. フォントの埋め込みオプションを組み合わせる</b></p>
<pre class="programlisting">&lt;?php
...
$font = Zend_Pdf_Font::fontWithPath($someUserSelectedFontPath,
                                    (Zend_Pdf_Font::EMBED_SUPPRESS_EMBED_EXCEPTION |
                                     Zend_Pdf_Font::EMBED_DONT_COMPRESS));
...
?&gt;
            </pre>
</div>
</div>
<div class="sect2" lang="ja">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.pdf.drawing.image-drawing"></a>20.5.6. 画像の描画</h3></div></div></div>
<p>
        <code class="code">Zend_Pdf_Page</code> クラスの drawImage() メソッドで、
        画像の描画を行います。
        </p>
<pre class="programlisting">
/**
 * ページ内の指定した位置に画像を描画します。
 *
 * @param Zend_Pdf_Image $image
 * @param float $x1
 * @param float $y1
 * @param float $x2
 * @param float $y2
 */
public function drawImage(Zend_Pdf_Image $image, $x1, $y1, $x2, $y2);
        </pre>
<p>
        画像オブジェクトは <code class="code">Zend_Pdf_Image</code>
        クラスを継承したクラスで表されます。
        </p>
<p>
        現在は JPG、PNG および TIFF 画像がサポートされています。
        </p>
<div class="example">
<a name="id4872174"></a><p class="title"><b>例 20.13. 画像の描画</b></p>
<pre class="programlisting">&lt;?php
...
// (以下のいずれかを使用して) 画像オブジェクトを直接作成します
$image = new Zend_Pdf_Image_JPEG('my_image.jpg');
$image = new Zend_Pdf_Image_TIFF('my_image.tiff');
$image = new Zend_Pdf_Image_PNG('my_image.png');

// あるいは Zend_Pdf_ImageFactory で適切な形式を読み込みます
$image = Zend_Pdf_ImageFactory::factory('my_image.jpg');

$pdfPage-&gt;drawImage($image, 100, 100, 400, 300);
...
?&gt;
            </pre>
</div>
<p>
            <span class="emphasis"><em>重要! Zend_Pdf_Image_JPEG クラスは PHP の GD 拡張モジュールを必要とします。</em></span>
            <span class="emphasis"><em>重要! Zend_Pdf_Image_PNG クラスでアルファチャネルを使用した画像を扱うには、ZLIB 拡張モジュールを必要とします。</em></span>
        </p>
<p>
            詳細な情報は、PHP のドキュメント
            (<a href="http://www.php.net/manual/ja/ref.image.php" target="_top">http://www.php.net/manual/ja/ref.image.php</a>),
            (<a href="http://www.php.net/manual/ja/ref.zlib.php" target="_top">http://www.php.net/manual/ja/ref.zlib.php</a>)
            を参照ください。
        </p>
</div>
<div class="sect2" lang="ja">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.pdf.drawing.line-drawing-style"></a>20.5.7. 直線の描画スタイル</h3></div></div></div>
<p>
        直線の描画スタイルは、線幅と線の色、そして破線のパターンで定義されます。
        これらはすべて、<code class="code">Zend_Pdf_Page</code> クラスのメソッドで設定します。
        </p>
<pre class="programlisting">
/** 線の色を設定します。*/
public function setLineColor(Zend_Pdf_Color $color);

/** 線の幅を設定します。*/
public function setLineWidth(float $width);

/**
 * 破線のパターンを設定します。
 *
 * pattern は float の配列です: array(on_length, off_length, on_length, off_length, ...)
 * phase は線の開始位置から移動する距離です。
 *
 * @param array $pattern
 * @param array $phase
 */
public function setLineDashingPattern($pattern, $phase = 0);
        </pre>
</div>
<div class="sect2" lang="ja">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.pdf.drawing.fill-style"></a>20.5.8. 塗りつぶしのスタイル</h3></div></div></div>
<p>
        <code class="code">Zend_Pdf_Page::drawRectangle()</code>、<code class="code">Zend_Pdf_Page::drawPoligon()</code>、
        <code class="code">Zend_Pdf_Page::drawCircle()</code> および <code class="code">Zend_Pdf_Page::drawEllipse()</code>
        メソッドは、オプションのパラメータとして <code class="code">$fillType</code>
        を受け取ります。これは以下のいずれかの値となります。
        </p>
<div class="itemizedlist"><ul type="disc">
<li><p>Zend_Pdf_Page::SHAPE_DRAW_STROKE - 図形の輪郭を描画します</p></li>
<li><p>Zend_Pdf_Page::SHAPE_DRAW_FILL - 図形を塗りつぶすだけです</p></li>
<li><p>Zend_Pdf_Page::SHAPE_DRAW_FILL_AND_STROKE - 輪郭を描画し、塗りつぶします (デフォルトの挙動です)</p></li>
</ul></div>
<p>
        <code class="code">Zend_Pdf_Page::drawPoligon()</code> メソッドには、さらにパラメータ
        <code class="code">$fillMethod</code> を指定することができます。
        </p>
<div class="itemizedlist"><ul type="disc">
<li>
<p>Zend_Pdf_Page::FILL_METHOD_NON_ZERO_WINDING (デフォルトの挙動)</p>
<p>
                <em class="citetitle">PDF リファレンス</em> によると、これは以下のように定義されています。
                </p>
<div class="blockquote"><blockquote class="blockquote"><p>
nonzero winding number ルールは、ある点がパスの内側にあるかどうかを
判断するため、その点からどこかの方向に放射線を引いて
その線がパスを構成する線と交わる場所を調べます。
0 からカウントをはじめ、放射線の左から右にパスの線が横切った場合に
+1、放射線の右から左に横切った場合に -1 します。
すべての交点について調べた後、もし結果が 0 ならその点はパスの外側です。
0 でなければ内側です。

注意: この方式では、放射線とパスの線が同一になった場合や
放射線がパスの線の接線となった場合のことを指定していません。
放射線は任意の方向に伸ばせるので、このような状況にならないような放射線が選ばれます。
単純な凸状のパスの場合、この方式で判断した内側・外側は、
直感的に予想できるのと同じ結果になります。
ただ、パスを構成する線自身が交わっているなどの複雑なパスの場合は、
興味深い結果となります。この例を、(PDF リファレンスの) 図 4.10 に示します。

5 本の直線を互いに交差させて作成した星型の場合、このルールでは
星型で囲まれるすべての部分をパスの内側として扱います。真ん中の
五角形も内側となります。2 つの同心円からなるパスの場合、
2 つの円が同じ方向に描画された際には両方の円に囲まれている部分が
内側となります。2 つの円が反対方向に描画された際には、2 つの円からなる
「ドーナツ型」の部分が内側となります。このルールの場合は、
「ドーナツの穴」の部分は外側という扱いになります。
                </p></blockquote></div>
<p>
            </p>
</li>
<li>
<p>Zend_Pdf_Const::FILLMETHOD_EVENODD</p>
<p>
                <em class="citetitle">PDF リファレンス</em> によると、これは以下のように定義されています。
                </p>
<div class="blockquote"><blockquote class="blockquote"><p>
nonzero winding number ルールに対するもうひとつのルールが even-odd ルールです。
このルールでは、ある点が「内側である」かどうかを判断する材料として、
その点からどこかの方向に放射線を引いてその線がパスを構成する線と何回交わるか
ということを用います。交わる回数が奇数だった場合、その点は内側です。
交わる回数が偶数だった場合、その点は外側です。単純なパスの場合は、
これは nonzero winding number ルールと同じ結果になります。
しかし、複雑な図形の場合は異なる結果となります。

複雑なパスに対して even-odd ルールを適用した場合の例を (PDF リファレンスの)
図 4.11 に示します。このルールの場合、5 本の交差する直線からなる星型では、
三角形の部分のみが内側として扱われます。真ん中の五角形は、内側とはみなされません。
2 つの同心円の場合、2 つの円からなる「ドーナツ型」の部分のみが内側として扱われます。
これは、円の描画された方向に依存しません。
                    </p></blockquote></div>
<p>
            </p>
</li>
</ul></div>
</div>
<div class="sect2" lang="ja">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.pdf.drawing.rotations"></a>20.5.9. 回転</h3></div></div></div>
<p>
        描画操作を適用する前に、PDF のページを回転させることができます。
        それには <code class="code">Zend_Pdf_Page::rotate()</code> メソッドを使用します。
        </p>
<pre class="programlisting">
/**
 * ($x, $y) を中心にし、指定した角度 (ラジアン) だけ回転します。
 *
 * @param float $angle
 */
public function rotate($x, $y, $angle);
        </pre>
</div>
<div class="sect2" lang="ja">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.pdf.drawing.save-restore"></a>20.5.10. グラフィックの状態の保存/復元</h3></div></div></div>
<p>
        好きな時点でのグラフィックの状態
        (現在のフォント、フォントサイズ、線の色、塗りつぶしの色、線の形式、
        ページの回転、クリップ領域) を保存/復元することができます。
        保存操作はグラフィックの状態をスタックに保存し、復元の際にはそこから取り出されます。
        </p>
<p>
        <code class="code">Zend_Pdf_Page</code>
        クラスには、これらの操作を行うための 2 つのメソッドがあります。
        </p>
<pre class="programlisting">
/**
 * このページのグラフィックの状態を保存します。
 * 現在適用されているスタイル・位置・クリップ領域および
 * 回転/移動/拡大縮小などを情報を保存します。
 */
public function saveGS();

/**
 * 直近の saveGS() で保存されたグラフィックの状態を復元します。
 */
public function restoreGS();
        </pre>
</div>
<div class="sect2" lang="ja">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.pdf.drawing.clipping"></a>20.5.11. 描画領域のクリッピング</h3></div></div></div>
<p>
        PDF および Zend_Pdf モジュールは、描画領域のクリッピングに対応しています。
        描画演算子が影響を及ぼす範囲を、このクリップ領域内に制限します。
        クリップ領域の初期値は、ページ全体です。
        </p>
<p>
        <code class="code">Zend_Pdf_Page</code> クラスでは、
        クリッピングに関連するいくつかのメソッドを提供しています。
        </p>
<pre class="programlisting">
/**
 * 矩形のクリップ領域を設定します。
 *
 * @param float $x1
 * @param float $y1
 * @param float $x2
 * @param float $y2
 */
public function clipRectangle($x1, $y1, $x2, $y2);
        </pre>
<pre class="programlisting">
/**
 * 多角形のクリップ領域を設定します。
 *
 * @param array $x  - float の配列 (頂点の X 座標)
 * @param array $y  - float の配列 (頂点の Y 座標)
 * @param integer $fillMethod
 */
public function clipPolygon($x, $y, $fillMethod = Zend_Pdf_Page::FILL_METHOD_NON_ZERO_WINDING);
        </pre>
<pre class="programlisting">
/**
 * 円形のクリップ領域を設定します。
 *
 * @param float $x
 * @param float $y
 * @param float $radius
 * @param float $startAngle
 * @param float $endAngle
 */
public function clipCircle($x, $y, $radius, $startAngle = null, $endAngle = null);
        </pre>
<pre class="programlisting">
/**
 * 楕円のクリップ領域を設定します。
 *
 * メソッドの書式
 * drawEllipse($x1, $y1, $x2, $y2);
 * drawEllipse($x1, $y1, $x2, $y2, $startAngle, $endAngle);
 *
 * @todo $x2-$x1 == 0 や $y2-$y1 == 0 のような特別な場合への対応
 *
 * @param float $x1
 * @param float $y1
 * @param float $x2
 * @param float $y2
 * @param float $startAngle
 * @param float $endAngle
 */
public function clipEllipse($x1, $y1, $x2, $y2, $startAngle = null, $endAngle = null);
        </pre>
</div>
<div class="sect2" lang="ja">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.pdf.drawing.styles"></a>20.5.12. スタイル</h3></div></div></div>
<p>
        <code class="code">Zend_Pdf_Style</code> クラスがスタイルに関する機能を提供します。
        </p>
<p>
        スタイルは、グラフィックの状態に関する複数の設定を保存し、
        PDF のページに 1 回の操作でそれを適用するために使用されます。
        </p>
<pre class="programlisting">
/**
 * このページの描画操作で使用する予定のスタイルを設定します。
 *
 * @param Zend_Pdf_Style $style
 */
public function setStyle(Zend_Pdf_Style $style);

/**
 * スタイルを返し、それをページに適用します。
 *
 * @return Zend_Pdf_Style|null
 */
public function getStyle();
        </pre>
<p>
        <code class="code">Zend_Pdf_Style</code> クラスでは、
        さまざまなグラフィックの状態を設定あるいは取得するためのメソッドが提供されています。
        </p>
<pre class="programlisting">
/**
 * 線の色を設定します。
 *
 * @param Zend_Pdf_Color $color
 */
public function setLineColor(Zend_Pdf_Color $color);
        </pre>
<pre class="programlisting">
/**
 * 線の色を取得します。
 *
 * @return Zend_Pdf_Color|null
 */
public function getLineColor();
        </pre>
<pre class="programlisting">
/**
 * 線の幅を設定します。
 *
 * @param float $width
 */
public function setLineWidth($width);
        </pre>
<pre class="programlisting">
/**
 * 線の幅を取得します。
 *
 * @return float
 */
public function getLineWidth();
        </pre>
<pre class="programlisting">
/**
 * 破線のパターンを設定します。
 *
 * @param array $pattern
 * @param float $phase
 */
public function setLineDashingPattern($pattern, $phase = 0);
        </pre>
<pre class="programlisting">
/**
 * 破線のパターンを取得します。
 *
 * @return array
 */
public function getLineDashingPattern();
        </pre>
<pre class="programlisting">
/**
 * 破線の位相を取得します。
 *
 * @return float
 */
public function getLineDashingPhase();
        </pre>
<pre class="programlisting">
/**
 * 塗りつぶし色を設定します。
 *
 * @param Zend_Pdf_Color $color
 */
public function setFillColor(Zend_Pdf_Color $color);
        </pre>
<pre class="programlisting">
/**
 * 塗りつぶし色を取得します。
 *
 * @return Zend_Pdf_Color|null
 */
public function getFillColor();
        </pre>
<pre class="programlisting">
/**
 * 現在のフォントを設定します。
 *
 * @param Zend_Pdf_Resource_Font $font
 * @param float $fontSize
 */
public function setFont(Zend_Pdf_Resource_Font $font, $fontSize);
        </pre>
<pre class="programlisting">
/**
 * 現在のフォントサイズを変更します。
 *
 * @param float $fontSize
 */
public function setFontSize($fontSize);
        </pre>
<pre class="programlisting">
/**
 * 現在のフォントを取得します。
 *
 * @return Zend_Pdf_Resource_Font $font
 */
public function getFont();
        </pre>
<pre class="programlisting">
/**
 * 現在のフォントサイズを取得します。
 *
 * @return float $fontSize
 */
public function getFontSize();
        </pre>
</div>
</div>
<div class="navfooter"><table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="zend.pdf.pages.html">前のページ</a> </td>
<td width="20%" align="center"><a accesskey="u" href="zend.pdf.html">上に戻る</a></td>
<td width="40%" align="right"> <a accesskey="n" href="zend.pdf.usage.html">次のページ</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">20.4. ドキュメントのページ </td>
<td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td>
<td width="40%" align="right" valign="top"> 20.6. Zend_Pdf モジュールの使用例</td>
</tr>
</table></div>
<div class="revinfo"></div>
</body>
</html>
