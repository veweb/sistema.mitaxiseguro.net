<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>4.3. Zend_Cache のフロントエンド</title>
<link rel="stylesheet" href="dbstyle.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.69.1">
<link rel="start" href="index.html" title="プログラマ向けリファレンスガイド">
<link rel="up" href="zend.cache.html" title="第4章 Zend_Cache">
<link rel="prev" href="zend.cache.theory.html" title="4.2. キャッシュの仕組み">
<link rel="next" href="zend.cache.backends.html" title="4.4. Zend_Cache のバックエンド">
<link rel="chapter" href="zend.html" title="第1章 Zend">
<link rel="chapter" href="zend.acl.html" title="第2章 Zend_Acl">
<link rel="chapter" href="zend.auth.html" title="第3章 Zend_Auth">
<link rel="chapter" href="zend.cache.html" title="第4章 Zend_Cache">
<link rel="chapter" href="zend.config.html" title="第5章 Zend_Config">
<link rel="chapter" href="zend.console.getopt.html" title="第6章 Zend_Console_Getopt">
<link rel="chapter" href="zend.controller.html" title="第7章 Zend_Controller">
<link rel="chapter" href="zend.date.html" title="第8章 Zend_Date">
<link rel="chapter" href="zend.db.html" title="第9章 Zend_Db">
<link rel="chapter" href="zend.feed.html" title="第10章 Zend_Feed">
<link rel="chapter" href="zend.filter.html" title="第11章 Zend_Filter">
<link rel="chapter" href="zend.gdata.html" title="第12章 Zend_Gdata">
<link rel="chapter" href="zend.http.html" title="第13章 Zend_Http">
<link rel="chapter" href="zend.json.html" title="第14章 Zend_Json">
<link rel="chapter" href="zend.locale.html" title="第15章 Zend_Locale">
<link rel="chapter" href="zend.log.html" title="第16章 Zend_Log">
<link rel="chapter" href="zend.mail.html" title="第17章 Zend_Mail">
<link rel="chapter" href="zend.measure.html" title="第18章 Zend_Measure">
<link rel="chapter" href="zend.mime.html" title="第19章 Zend_Mime">
<link rel="chapter" href="zend.pdf.html" title="第20章 Zend_Pdf">
<link rel="chapter" href="zend.rest.html" title="第21章 Zend_Rest">
<link rel="chapter" href="zend.search.html" title="第22章 Zend_Search">
<link rel="chapter" href="zend.server.html" title="第23章 Zend_Server">
<link rel="chapter" href="zend.service.html" title="第24章 Zend_Service">
<link rel="chapter" href="zend.session.html" title="第25章 Zend_Session">
<link rel="chapter" href="zend.uri.html" title="第26章 Zend_Uri">
<link rel="chapter" href="zend.validate.html" title="第27章 Zend_Validate">
<link rel="chapter" href="zend.view.html" title="第28章 Zend_View">
<link rel="chapter" href="zend.xmlrpc.html" title="第29章 Zend_XmlRpc">
<link rel="appendix" href="coding-standard.html" title="付録 A. Zend Framework PHP 標準コーディング規約">
<link rel="appendix" href="copyrights.html" title="付録 B. 著作権に関する情報">
<link rel="index" href="the.index.html" title="目次">
<link rel="subsection" href="zend.cache.frontends.html#zend.cache.core" title="4.3.1. Zend_Cache_Core">
<link rel="subsection" href="zend.cache.frontends.html#zend.cache.frontend.output" title="4.3.2. Zend_Cache_Frontend_Output">
<link rel="subsection" href="zend.cache.frontends.html#zend.cache.frontend.function" title="4.3.3. Zend_Cache_Frontend_Function">
<link rel="subsection" href="zend.cache.frontends.html#zend.cache.frontend.class" title="4.3.4. Zend_Cache_Frontend_Class">
<link rel="subsection" href="zend.cache.frontends.html#zend.cache.frontends.file" title="4.3.5. Zend_Cache_Frontend_File">
<link rel="subsection" href="zend.cache.frontends.html#zend.cache.frontends.page" title="4.3.6. Zend_Cache_Frontend_Page">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader"><table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">4.3. Zend_Cache のフロントエンド</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="zend.cache.theory.html">前のページ</a> </td>
<th width="60%" align="center">第4章 Zend_Cache</th>
<td width="20%" align="right"> <a accesskey="n" href="zend.cache.backends.html">次のページ</a>
</td>
</tr>
</table></div>
<div class="sect1" lang="ja">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="zend.cache.frontends"></a>4.3. Zend_Cache のフロントエンド</h2></div></div></div>
<div class="sect2" lang="ja">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.cache.core"></a>4.3.1. Zend_Cache_Core</h3></div></div></div>
<div class="sect3" lang="ja">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.cache.core.introduction"></a>4.3.1.1. 導入</h4></div></div></div>
<p>
                <code class="code">Zend_Cache_Core</code> は特別なフロントエンドであり、
                モジュールのコアに含まれています。これはキャッシュフロントエンドの
                基本機能を実装したものであり、他のクラスによってオーバーライドされます。
            </p>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[注意]" src="images/note.png"></td>
<th align="left">注意</th>
</tr>
<tr><td align="left" valign="top"><p>
                その他のフロントエンドクラスは、すべて <code class="code">Zend_Cache_Core</code>
                を継承しており、以下で説明しているメソッドおよびオプションは
                他のフロントエンドでも使用可能です。そのため、ここではこれらについての
                詳しい説明は省略します。
            </p></td></tr>
</table></div>
</div>
<div class="sect3" lang="ja">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.cache.core.options"></a>4.3.1.2. 使用可能なオプション</h4></div></div></div>
<p>
                これらのオプションを、先の例で示したようにファクトリメソッドに渡します。
            </p>
<div class="table">
<a name="id4788809"></a><p class="title"><b>表 4.1. 使用可能なオプション</b></p>
<table summary="使用可能なオプション" border="1">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead><tr>
<th>オプション</th>
<th>データ型</th>
<th>デフォルト値</th>
<th>説明</th>
</tr></thead>
<tbody>
<tr>
<td><code class="code">caching</code></td>
<td><code class="code">boolean</code></td>
<td><code class="code">true</code></td>
<td>
                                  キャッシングを有効/無効にします
                                  (キャッシュされたスクリプトのデバッグ時に有用です)。
                              </td>
</tr>
<tr>
<td><code class="code">lifeTime</code></td>
<td><code class="code">int</code></td>
<td><code class="code">3600</code></td>
<td>
                                キャッシュの有効期間 (秒)。<code class="code">null</code>
                                を指定すると、有効期間が無期限となります。
                              </td>
</tr>
<tr>
<td><code class="code">logging</code></td>
<td><code class="code">boolean</code></td>
<td><code class="code">false</code></td>
<td>
                                true を指定すると、<code class="code">Zend_Log</code> によるロギングが有効になります
                                (しかし、処理速度は低下します)。
                              </td>
</tr>
<tr>
<td><code class="code">writeControl</code></td>
<td><code class="code">boolean</code></td>
<td><code class="code">true</code></td>
<td>
                                書き込み制御を有効/無効にします (壊れたエントリを検出するため、
                                書き込んだ直後にそのキャッシュを読み込みます)。
                                writeControl を有効にすると、キャッシュの書き込みがやや遅くなりますが、
                                読み込みの速度は変わりません
                                (これはキャッシュファイルが壊れているかどうかを調べるものですが、
                                完全に判断できるわけではありません)。
                              </td>
</tr>
<tr>
<td><code class="code">automaticSerialization</code></td>
<td><code class="code">boolean</code></td>
<td><code class="code">false</code></td>
<td>
                                自動シリアライズを有効/無効にします。
                                文字列でないデータを直接保存する際に使用します
                                (しかし、処理速度は低下します)。
                              </td>
</tr>
<tr>
<td><code class="code">automaticCleaningFactor</code></td>
<td><code class="code">int</code></td>
<td><code class="code">10</code></td>
<td>
                                自動クリーンアッププロセス (ガベージコレクタ) の設定を行います。
                                0 を指定すると、自動キャッシュクリーニングを行いません。
                                1 を指定すると計画的にキャッシュのクリーニングを行い、また
                                x (1 より大きな整数) を指定すると、
                                x 回のキャッシュ書き込みについて 1 回の頻度で
                                ランダムに自動クリーニングを行います。
                              </td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3" lang="ja">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.cache.core.examples"></a>4.3.1.3. 例</h4></div></div></div>
<p>
                マニュアルのいちばんはじめのほうに、例を示しています。
            </p>
<p>
                もしキャッシュに文字列しか保存しないのなら
                ("automaticSerialization" オプションを使用すると boolean も保存できるので)、
                このようにもう少しコンパクトに作成することが可能です。
            </p>
<pre class="programlisting">&lt;?php  
             
// すでに $cache が存在するものとします

$id = 'myBigLoop'; //「キャッシュしたい内容」のキャッシュ ID

if (!($data = $cache-&gt;load($id))) {
    // キャッシュが存在しませんでした
    
    $data = '';
    for ($i = 0; $i &lt; 10000; $i++) {
        $data = $data . $i;
    }
    
    $cache-&gt;save($data);
    
} 

// [...] $data を用いて何かをします (echo したり、何かに渡したりなど)
             
?&gt;       </pre>
<p>
                複数のブロックやデータのインスタンスをキャッシュしたい場合も、考え方は同じです。
            </p>
<pre class="programlisting">&lt;?php  
             
// 一意な ID を使用するようにしましょう
$id1 = 'foo';
$id2 = 'bar';

// ブロック 1
if (!($data = $cache-&gt;load($id1))) {
    // キャッシュが存在しませんでした
    
    $data = '';
    for ($i=0;$i&lt;10000;$i++) {
        $data = $data . $i;
    }
    
    $cache-&gt;save($data);
    
} 
echo($data);

// これは、キャッシュ処理の影響を受けません
echo('キャッシュされません !');

// ブロック 2
if (!($data = $cache-&gt;load($id2))) {
    // キャッシュが存在しませんでした
    
    $data = '';
    for ($i=0;$i&lt;10000;$i++) {
        $data = $data . '!';
    }
    
    $cache-&gt;save($data);
    
} 
echo($data);

?&gt;       </pre>
</div>
</div>
<div class="sect2" lang="ja">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.cache.frontend.output"></a>4.3.2. Zend_Cache_Frontend_Output</h3></div></div></div>
<div class="sect3" lang="ja">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.cache.frontend.output.introduction"></a>4.3.2.1. 導入</h4></div></div></div>
<p>
                <code class="code">Zend_Cache_Frontend_Output</code> は、出力を横取りするフロントエンドです。
                これは PHP の出力バッファリング処理を使いやすくしたもので、
                <code class="code">start()</code> メソッドと
                <code class="code">end()</code> メソッドの間の出力を横取りします。
            </p>
</div>
<div class="sect3" lang="ja">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.cache.frontend.output.options"></a>4.3.2.2. 使用可能なオプション</h4></div></div></div>
<p>
                <code class="code">Zend_Cache_Core</code> のオプション以外に、
                このフロントエンドが独自に使用するオプションはありません。
            </p>
</div>
<div class="sect3" lang="ja">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.cache.frontend.output.examples"></a>4.3.2.3. 例</h4></div></div></div>
<p>
                このマニュアルの冒頭に示した例とほとんど同じですが、少しだけ変更を加えています。
            </p>
<pre class="programlisting">&lt;?php

// キャッシュが見つからなかった場合に、出力バッファリングが起動します
if(!$cache-&gt;start('mypage')):

// すべてをいつもどおりに出力します
echo 'Hello world! ';
echo 'これはキャッシュされます ('.time().') ';

$cache-&gt;end(); // 出力バッファリングを終了します
endif;

echo 'これはキャッシュされません ('.time().')';

?&gt;       </pre>
<p>
                この形式を使用すると、既存のプロジェクトに簡単に出力キャッシュ処理を追加することができます。
                コードのリファクタリングもほとんど行わずにすませられるでしょう。
            </p>
</div>
</div>
<div class="sect2" lang="ja">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.cache.frontend.function"></a>4.3.3. Zend_Cache_Frontend_Function</h3></div></div></div>
<div class="sect3" lang="ja">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.cache.frontend.function.introduction"></a>4.3.3.1. 導入</h4></div></div></div>
<p>
                <code class="code">Zend_Cache_Frontend_Function</code> は、関数コールの結果をキャッシュします。
                <code class="code">call()</code> というメソッドを保持しており、
                関数名とパラメータを配列にしてこのメソッドに渡します。
            </p>
</div>
<div class="sect3" lang="ja">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.cache.frontend.function.options"></a>4.3.3.2. 使用可能なオプション</h4></div></div></div>
<div class="table">
<a name="id4790143"></a><p class="title"><b>表 4.2. 使用可能なオプション</b></p>
<table summary="使用可能なオプション" border="1">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead><tr>
<th>オプション</th>
<th>データ型</th>
<th>デフォルト値</th>
<th>説明</th>
</tr></thead>
<tbody>
<tr>
<td><code class="code">cacheByDefault</code></td>
<td><code class="code">boolean</code></td>
<td><code class="code">true</code></td>
<td>
                                  true の場合は、関数のコール結果がデフォルトでキャッシュされます。
                              </td>
</tr>
<tr>
<td><code class="code">cachedFunctions</code></td>
<td><code class="code">array</code></td>
<td> </td>
<td>
                                  常にキャッシュされる関数の名前。
                              </td>
</tr>
<tr>
<td><code class="code">nonCachedFunctions</code></td>
<td><code class="code">array</code></td>
<td> </td>
<td>
                                  決してキャッシュされない関数の名前。
                              </td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3" lang="ja">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.cache.frontend.function.examples"></a>4.3.3.3. 例</h4></div></div></div>
<p>
                <code class="code">call()</code> 関数の使用法は、PHP の
                <code class="code">call_user_func_array()</code> と同じです。
            </p>
<pre class="programlisting">&lt;?php

$cache-&gt;call('veryExpensiveFunc', $params);

# $params は配列です。
# 例えば、veryExpensiveFunc(1, 'foo', 'bar') のコールをキャッシュするには
# $cache-&gt;call('veryExpensiveFunc', array(1, 'foo', 'bar')) とします。

?&gt;       </pre>
<p>
                <code class="code">Zend_Cache_Frontend_Function</code> は、
                関数の返り値だけでなく関数内部での出力もキャッシュします。
            </p>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[注意]" src="images/note.png"></td>
<th align="left">注意</th>
</tr>
<tr><td align="left" valign="top"><p>
                <code class="code">array()</code>、<code class="code">echo()</code>、<code class="code">empty()</code>、<code class="code">eval()</code>、
                <code class="code">exit()</code>、<code class="code">isset()</code>、<code class="code">list()</code>、<code class="code">print()</code>
                および <code class="code">unset()</code> 以外なら、
                任意の組み込み関数やユーザ定義関数を渡すことができます。
            </p></td></tr>
</table></div>
</div>
</div>
<div class="sect2" lang="ja">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.cache.frontend.class"></a>4.3.4. Zend_Cache_Frontend_Class</h3></div></div></div>
<div class="sect3" lang="ja">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.cache.frontend.class.introduction"></a>4.3.4.1. 導入</h4></div></div></div>
<p>
                <code class="code">Zend_Cache_Frontend_Class</code> は、<code class="code">Zend_Cache_Frontend_Function</code>
                と異なり、オブジェクトおよびスタティックメソッドのコールをキャッシュします。
            </p>
</div>
<div class="sect3" lang="ja">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.cache.frontend.class.options"></a>4.3.4.2. 使用可能なオプション</h4></div></div></div>
<div class="table">
<a name="id4790378"></a><p class="title"><b>表 4.3. 使用可能なオプション</b></p>
<table summary="使用可能なオプション" border="1">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead><tr>
<th>オプション</th>
<th>データ型</th>
<th>デフォルト値</th>
<th>説明</th>
</tr></thead>
<tbody>
<tr>
<td>
<code class="code">cachedEntity</code> (必須)</td>
<td><code class="code">mixed</code></td>
<td> </td>
<td>
                                  クラス名を設定すると、抽象クラスおよびスタティックコールをキャッシュします。
                                  オブジェクトを設定すると、そのオブジェクトのメソッドをキャッシュします。
                              </td>
</tr>
<tr>
<td><code class="code">cacheByDefault</code></td>
<td><code class="code">boolean</code></td>
<td><code class="code">true</code></td>
<td>
                                  true を設定すると、デフォルトでキャッシュされます。
                              </td>
</tr>
<tr>
<td><code class="code">cachedMethods</code></td>
<td><code class="code">array</code></td>
<td> </td>
<td>
                                  常にキャッシュされるメソッドの名前。
                              </td>
</tr>
<tr>
<td><code class="code">nonCachedMethods</code></td>
<td><code class="code">array</code></td>
<td> </td>
<td>
                                  決してキャッシュされないメソッドの名前。
                              </td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3" lang="ja">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.cache.frontend.class.examples"></a>4.3.4.3. 例</h4></div></div></div>
<p>
                例えば、スタティックメソッドのコールをキャッシュするには次のようにします。
            </p>
<pre class="programlisting">&lt;?php

class test {
   
    # スタティックメソッド
    public static function foobar($param1, $param2) {
        echo "foobar_output($param1, $param2)";
        return "foobar_return($param1, $param2)";   
    }

}

// [...]
$frontendOptions = array(
    'cachedEntity' =&gt; 'test' // クラス名を指定します
);
// [...]

# これはキャッシュされます
$res = $cache-&gt;foobar('1', '2');

?&gt;       </pre>
<p>
                通常のメソッドのコールをキャッシュするには次のようにします。
            </p>
<pre class="programlisting">&lt;?php

class test {
   
    private $_string = 'hello !';
      
    public function foobar2($param1, $param2) {
        echo($this-&gt;_string);
        echo "foobar2_output($param1, $param2)";
        return "foobar2_return($param1, $param2)";   
    }

}

// [...]
$frontendOptions = array(
    'cachedEntity' =&gt; new test() // クラスのインスタンスを指定します
);
// [...]

# これはキャッシュされます
$res = $cache-&gt;foobar2('1', '2');

?&gt;       </pre>
</div>
</div>
<div class="sect2" lang="ja">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.cache.frontends.file"></a>4.3.5. Zend_Cache_Frontend_File</h3></div></div></div>
<div class="sect3" lang="ja">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.cache.frontends.file.introduction"></a>4.3.5.1. 導入</h4></div></div></div>
<p>
                <code class="code">Zend_Cache_Frontend_File</code> は、マスタファイルの
                「更新時刻」にもとづいて動作するフロントエンドです。
                これは、例えば設定ファイルやテンプレートなどで有効に使えるでしょう。
            </p>
<p> 
                例えば、XML の設定ファイルを使用しており、それが「設定オブジェクト」
                (<code class="code">Zend_Config</code> など) を返す関数でパースされるとしましょう。
                <code class="code">Zend_Cache_Frontend_File</code> を使用すると、その「設定オブジェクト」
                をキャッシュすることができ (これにより、
                XML ファイルを毎回パースする必要がなくなります)、さらに「マスタファイル」
                との間で強力な依存性を保持することができます。そのため、XML
                設定ファイルが更新されると、即時にキャッシュが無効になります。
            </p>
</div>
<div class="sect3" lang="ja">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.cache.frontends.file.options"></a>4.3.5.2. 使用可能なオプション</h4></div></div></div>
<div class="table">
<a name="id4790650"></a><p class="title"><b>表 4.4. 使用可能なオプション</b></p>
<table summary="使用可能なオプション" border="1">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead><tr>
<th>オプション</th>
<th>データ型</th>
<th>デフォルト値</th>
<th>説明</th>
</tr></thead>
<tbody><tr>
<td><code class="code">masterFile (必須)</code></td>
<td><code class="code">string</code></td>
<td><code class="code"></code></td>
<td>
                                  マスタファイルへのフルパス。
                              </td>
</tr></tbody>
</table>
</div>
</div>
<div class="sect3" lang="ja">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.cache.frontends.file.examples"></a>4.3.5.3. 例</h4></div></div></div>
<p>
                このフロントエンドの使用法は <code class="code">Zend_Cache_Core</code> と同じです。
                そのため、特に例は用意していません。唯一しなければならないことは、
                ファクトリを使用する際に、バックエンドのオプションとして
                <code class="code">masterFile</code> を設定することだけです。
            </p>
</div>
</div>
<div class="sect2" lang="ja">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.cache.frontends.page"></a>4.3.6. Zend_Cache_Frontend_Page</h3></div></div></div>
<div class="sect3" lang="ja">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.cache.frontends.page.introduction"></a>4.3.6.1. 導入</h4></div></div></div>
<p>
                <code class="code">Zend_Cache_Frontend_Page</code> は <code class="code">Zend_Cache_Frontend_Output</code>
                と似ていますが、ページ全体をキャッシュする目的で設計されています。
                <code class="code">Zend_Cache_Frontend_Page</code> を使用して、
                ページの一部だけをキャッシュすることはできません。
            </p>
<p>
                一方、「キャッシュ ID」は自動的に生成されます。この ID は、
                <code class="code">$_SERVER['REQUEST_URI']</code> および (オプションの設定によっては) 
                <code class="code">$_GET</code>、<code class="code">$_POST</code>、<code class="code">$_SESSION</code>、
                <code class="code">$_COOKIE</code>、<code class="code">$_FILES</code> をもとにして生成されます。
                さらに、ひとつのメソッド (<code class="code">start()</code>) をコールするだけで使用できます。
                <code class="code">end()</code> は、ページの終了時に自動的にコールされます。
            </p>
<p>
                現時点ではまだ実装されていませんが、将来は HTTP conditional システムを追加する予定です。
                これにより、ネットワークの帯域を節約できるようになります
                (キャッシュにヒットし、かつブラウザがそのバージョンを既に持っている場合に
                HTTP 304 Not Modified を送信するようにします)。
            </p>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[注意]" src="images/note.png"></td>
<th align="left">注意</th>
</tr>
<tr><td align="left" valign="top"><p>
                Zend_Cache_Frontend_Page は「アルファ版」であり、
                実用できるようになるまでにはまだまだ時間がかかるでしょう。
            </p></td></tr>
</table></div>
</div>
<div class="sect3" lang="ja">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.cache.frontends.page.options"></a>4.3.6.2. (Zend_Cache ファクトリで、このフロントエンドを使用する際に) 使用可能なオプション</h4></div></div></div>
<div class="table">
<a name="id4790862"></a><p class="title"><b>表 4.5. 使用可能なオプション</b></p>
<table summary="使用可能なオプション" border="1">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead><tr>
<th>オプション</th>
<th>データ型</th>
<th>デフォルト値</th>
<th>説明</th>
</tr></thead>
<tbody>
<tr>
<td><code class="code">httpConditional</code></td>
<td><code class="code">boolean</code></td>
<td><code class="code">false</code></td>
<td>
                                  httpConditional システムを使用します (現時点ではまだ実装されていません)。
                              </td>
</tr>
<tr>
<td><code class="code">debugHeader</code></td>
<td><code class="code">boolean</code></td>
<td><code class="code">false</code></td>
<td>
                                  true の場合は、キャッシュされた各ページの先頭に
                                  デバッグ用テキストが追加されます。
                              </td>
</tr>
<tr>
<td><code class="code">defaultOptions</code></td>
<td><code class="code">array</code></td>
<td><code class="code">array(...説明を参照ください...)</code></td>
<td>
                                  デフォルトのオプションを表す連想配列です。
                                  <div class="itemizedlist"><ul type="disc">
<li><p>
                                              <code class="code">(boolean, デフォルトは true) cache</code> :
                                              true の場合はキャッシュが有効になります。
                                          </p></li>
<li><p>
                                              <code class="code">(boolean, デフォルトは false) cacheWithGetVariables</code> :
                                              true の場合は、<code class="code">$_GET</code> 配列に変数が含まれていてもキャッシュがオンのままになります。
                                          </p></li>
<li><p>
                                              <code class="code">(boolean, デフォルトは false) cacheWithPostVariables</code> :
                                              true の場合は、<code class="code">$_POST</code> 配列に変数が含まれていてもキャッシュがオンのままになります。
                                          </p></li>
<li><p>
                                              <code class="code">(boolean, デフォルトは false) cacheWithSessionVariables</code> :
                                              true の場合は、<code class="code">$_SESSION</code> 配列に変数が含まれていてもキャッシュがオンのままになります。
                                          </p></li>
<li><p>
                                              <code class="code">(boolean, デフォルトは false) cacheWithFilesVariables</code> :
                                              true の場合は、<code class="code">$_FILES</code> 配列に変数が含まれていてもキャッシュがオンのままになります。
                                          </p></li>
<li><p>
                                              <code class="code">(boolean, デフォルトは false) cacheWithCookieVariables</code> :
                                              true の場合は、<code class="code">$_COOKIE</code> 配列に変数が含まれていてもキャッシュがオンのままになります。
                                          </p></li>
<li><p>
                                              <code class="code">(boolean, デフォルトは true) makeIdWithGetVariables</code> :
                                              true の場合は、キャッシュ ID が <code class="code">$_GET</code> 配列の内容に依存するようになります。
                                          </p></li>
<li><p>
                                              <code class="code">(boolean, デフォルトは true) makeIdWithPostVariables</code> :
                                              true の場合は、キャッシュ ID が <code class="code">$_POST</code> 配列の内容に依存するようになります。
                                          </p></li>
<li><p>
                                              <code class="code">(boolean, デフォルトは true) makeIdWithSessionVariables</code> :
                                              true の場合は、キャッシュ ID が <code class="code">$_SESSION</code> 配列の内容に依存するようになります。
                                          </p></li>
<li><p>
                                              <code class="code">(boolean, デフォルトは true) makeIdWithFilesVariables</code> :
                                              true の場合は、キャッシュ ID が <code class="code">$_FILES</code> 配列の内容に依存するようになります。
                                          </p></li>
<li><p>
                                              <code class="code">(boolean, デフォルトは true) makeIdWithCookieVariables</code> :
                                              true の場合は、キャッシュ ID が <code class="code">$_COOKIE</code> 配列の内容に依存するようになります。
                                          </p></li>
</ul></div>
                              </td>
</tr>
<tr>
<td><code class="code">regexps</code></td>
<td><code class="code">array</code></td>
<td><code class="code">array()</code></td>
<td>
                                  特定の REQUEST_URI に対してのみ適用するオプションを設定する連想配列です。
                                  キーが (PCRE の) 正規表現、対応する値は連想配列となります。
                                  この連想配列には、正規表現が $_SERVER['REQUEST_URI']
                                  にマッチした場合に設定されるオプションを設定します
                                  (使用可能なオプションについては defaultOptions を参照ください)。
                                  複数の正規表現が $_SERVER['REQUEST_URI'] にマッチした場合は、
                                  一番最後にマッチしたもののみが使用されます。
                              </td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3" lang="ja">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.cache.frontends.page.examples"></a>4.3.6.3. 例</h4></div></div></div>
<p>
                Zend_Cache_Frontend_Page の使用法は、きわめて簡単です。
            </p>
<pre class="programlisting">&lt;?php
               
// [...] // require、設定そしてファクトリ
    
$cache-&gt;start();
// キャッシュにヒットした場合はその結果がブラウザに送信され、処理はここで停止します
    
// ページの残りの部分 ...
    
?&gt;       </pre>
<p>
                もう少し複雑な例を見てみましょう。これは、起動ファイル
                (例えば Zend_Controller など) 内でキャッシュを集中管理する方法を示したものです。
            </p>
<pre class="programlisting">&lt;?php

// [...] キャッシュセクションの前には、あまり多くの行を書かないようにしましょう。
// [...] 例えば、処理速度を最適化するためには "require_once" や "Zend::loadClass"
// [...] をキャッシュセクションの後におくべきです。

require_once 'Zend/Cache.php';

$frontendOptions = array(
   'lifeTime' =&gt; 7200,
   'debugHeader' =&gt; true, // デバッグ用
   'regexps' =&gt; array(
       '^/$' =&gt; array('cache' =&gt; true),         // IndexController 全体をキャッシュします
       '^/index/' =&gt; array('cache' =&gt; true),    // IndexController 全体をキャッシュします
       '^/article/' =&gt; array('cache' =&gt; false), // ArticleController はキャッシュしません
       '^/article/view/' =&gt; array(              // ……が、ArticleController の "view" アクションは
           'cache' =&gt; true,                     // キャッシュします。また、たとえ $_POST に何らかの
           'cacheWithPostVariables' =&gt; true,    // 変数が含まれていてもキャッシュを行います
           'makeIdWithPostVariables' =&gt; true,   // (しかし、そのキャッシュは $_POST 配列に依存します)。
       )
   )      
);
$backendOptions = array(
    'cacheDir' =&gt; '/tmp/' 
);

// Zend_Cache_Frontend_Page オブジェクトを取得します
$cache = Zend_Cache::factory('Page', 'File', $frontendOptions, $backendOptions);

$cache-&gt;start();
// キャッシュにヒットした場合はその結果がブラウザに送信され、スクリプトの処理はここで停止します。

// [...] 起動ファイルの終点 (これらの行は、キャッシュにヒットした場合は実行されません)。
                
?&gt;       </pre>
</div>
</div>
</div>
<div class="navfooter"><table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="zend.cache.theory.html">前のページ</a> </td>
<td width="20%" align="center"><a accesskey="u" href="zend.cache.html">上に戻る</a></td>
<td width="40%" align="right"> <a accesskey="n" href="zend.cache.backends.html">次のページ</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">4.2. キャッシュの仕組み </td>
<td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td>
<td width="40%" align="right" valign="top"> 4.4. Zend_Cache のバックエンド</td>
</tr>
</table></div>
<div class="revinfo"></div>
</body>
</html>
