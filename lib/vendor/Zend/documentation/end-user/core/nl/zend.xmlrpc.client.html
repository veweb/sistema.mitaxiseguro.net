<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>29.2. Zend_XmlRpc_Client</title>
<link rel="stylesheet" href="dbstyle.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.69.1">
<link rel="start" href="index.html" title="Referentiegids voor de programmeur">
<link rel="up" href="zend.xmlrpc.html" title="Hoofdstuk 29. Zend_XmlRpc">
<link rel="prev" href="zend.xmlrpc.html" title="Hoofdstuk 29. Zend_XmlRpc">
<link rel="next" href="zend.xmlrpc.server.html" title="29.3. Zend_XmlRpc_Server">
<link rel="chapter" href="zend.html" title="Hoofdstuk 1. Zend">
<link rel="chapter" href="zend.acl.html" title="Hoofdstuk 2. Zend_Acl">
<link rel="chapter" href="zend.auth.html" title="Hoofdstuk 3. Zend_Auth">
<link rel="chapter" href="zend.cache.html" title="Hoofdstuk 4. Zend_Cache">
<link rel="chapter" href="zend.config.html" title="Hoofdstuk 5. Zend_Config">
<link rel="chapter" href="zend.console.getopt.html" title="Hoofdstuk 6. Zend_Console_Getopt">
<link rel="chapter" href="zend.controller.html" title="Hoofdstuk 7. Zend_Controller">
<link rel="chapter" href="zend.date.html" title="Hoofdstuk 8. Zend_Date">
<link rel="chapter" href="zend.db.html" title="Hoofdstuk 9. Zend_Db">
<link rel="chapter" href="zend.feed.html" title="Hoofdstuk 10. Zend_Feed">
<link rel="chapter" href="zend.filter.html" title="Hoofdstuk 11. Zend_Filter">
<link rel="chapter" href="zend.gdata.html" title="Hoofdstuk 12. Zend_Gdata">
<link rel="chapter" href="zend.http.html" title="Hoofdstuk 13. Zend_Http">
<link rel="chapter" href="zend.json.html" title="Hoofdstuk 14. Zend_Json">
<link rel="chapter" href="zend.locale.html" title="Hoofdstuk 15. Zend_Locale">
<link rel="chapter" href="zend.log.html" title="Hoofdstuk 16. Zend_Log">
<link rel="chapter" href="zend.mail.html" title="Hoofdstuk 17. Zend_Mail">
<link rel="chapter" href="zend.measure.html" title="Hoofdstuk 18. Zend_Measure">
<link rel="chapter" href="zend.mime.html" title="Hoofdstuk 19. Zend_Mime">
<link rel="chapter" href="zend.pdf.html" title="Hoofdstuk 20. Zend_Pdf">
<link rel="chapter" href="zend.rest.html" title="Hoofdstuk 21. Zend_Rest">
<link rel="chapter" href="zend.search.html" title="Hoofdstuk 22. Zend_Search">
<link rel="chapter" href="zend.server.html" title="Hoofdstuk 23. Zend_Server">
<link rel="chapter" href="zend.service.html" title="Hoofdstuk 24. Zend_Service">
<link rel="chapter" href="zend.session.html" title="Hoofdstuk 25. Zend_Session">
<link rel="chapter" href="zend.uri.html" title="Hoofdstuk 26. Zend_Uri">
<link rel="chapter" href="zend.validate.html" title="Hoofdstuk 27. Zend_Validate">
<link rel="chapter" href="zend.view.html" title="Hoofdstuk 28. Zend_View">
<link rel="chapter" href="zend.xmlrpc.html" title="Hoofdstuk 29. Zend_XmlRpc">
<link rel="appendix" href="coding-standard.html" title="Bijlage A. Zend Framework Programmeer Standaard">
<link rel="appendix" href="copyrights.html" title="Bijlage B. Auteursrechtinformatie">
<link rel="index" href="the.index.html" title="Register">
<link rel="subsection" href="zend.xmlrpc.client.html#zend.xmlrpc.client.introduction" title="29.2.1. Inleiding">
<link rel="subsection" href="zend.xmlrpc.client.html#zend.xmlrpc.client.parameters" title="29.2.2. Parameters gebruiken">
<link rel="subsection" href="zend.xmlrpc.client.html#zend.xmlrpc.client.wsdl" title="29.2.3. Hints geven voor parameter types">
<link rel="subsection" href="zend.xmlrpc.client.html#zend.xmlrpc.client.response" title="29.2.4. Het antwoord terugkrijgen">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader"><table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">29.2. Zend_XmlRpc_Client</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="zend.xmlrpc.html">Terug</a> </td>
<th width="60%" align="center">Hoofdstuk 29. Zend_XmlRpc</th>
<td width="20%" align="right"> <a accesskey="n" href="zend.xmlrpc.server.html">Volgende</a>
</td>
</tr>
</table></div>
<div class="sect1" lang="nl">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="zend.xmlrpc.client"></a>29.2. Zend_XmlRpc_Client</h2></div></div></div>
<div class="sect2" lang="nl">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.xmlrpc.client.introduction"></a>29.2.1. Inleiding</h3></div></div></div>
<p>
			Het gebruik van de <code class="code">Zend_XmlRpc_Client</code> komt erg overeen met het gebruik van <code class="code">SoapClient</code> objecten (<a href="http://www.php.net/soap" target="_top">SOAP web service extensie</a>).
			Je kan gewoonweg de XML-RPC service procedures aanroepen als  <code class="code">Zend_XmlRpc_Client</code> methodes.
			Specificeer het volledige adres van de service in de <code class="code">Zend_XmlRpc_Client</code> constructor.
		</p>
<div class="example">
<a name="id4889698"></a><p class="title"><b>Voorbeeld 29.1. Een basis XML-RPC verzoek</b></p>
<pre class="programlisting">&lt;?php
/**
* Maak verbinding met de framework.zend.com server en krijg een array met de beschikbare methodes.
*/
require_once 'Zend/XmlRpc/Client.php';

$server = new Zend_XmlRpc_Client('http://framework.zend.com/xmlrpc');

print_r( $server-&gt;system-&gt;listMethods() );
?&gt;
				</pre>
</div>
<p>
				</p>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Opmerking]" src="images/note.png"></td>
<th align="left">Opmerking</th>
</tr>
<tr><td align="left" valign="top"><p>De <code class="code">Zend_XmlRpc_Client</code> probeert het op afstand aanroepen van methodes
					zoveel mogelijk als PHP-eigen methodes te laten lijken. Als een remote methode namespaces bevat
					zoals <code class="code">system.listMethods()</code> hierboven, word de aanroep via "object chaining" gemaakt
					in PHP: <code class="code">$server-&gt;system-&gt;listMethods()</code>.</p></td></tr>
</table></div>
<p>
			</p>
</div>
<div class="sect2" lang="nl">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.xmlrpc.client.parameters"></a>29.2.2. Parameters gebruiken</h3></div></div></div>
<p>
				Sommige XML-RPC service procedures vereisen parameters. De benodigde parameters worden als parameters voor
				de <code class="code">Zend_XmlRpc-Client</code> methode doorgegeven.
				Parameters voor een XML-RPC procedure moeten van een bepaald XML-RPC type zijn.
				Parameters kunnen op 2 manieren worden doorgegeven: als PHP-eigen variabelen of <code class="code">Zend_XmlRpc_Value</code>
				objecten die XML-RPC types voorstellen.
			</p>
<div class="sect3" lang="nl">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.xmlrpc.client.parameters.php_native"></a>29.2.2.1. PHP-eigen variabelen als parameters doorgeven</h4></div></div></div>
<p>
					Parameters zoals een string, integer, float, boolean, array of object worden beschouwd als PHP-eigen variabelen
					en zullen ook zo worden doorgegeven.
					In dit geval zal elk PHP-eigen type automatisch worden herkend en geconverteerd in een van de overeenkomstige
					XML-RPC types aan de hand van de volgende tabel:
				</p>
<div class="table">
<a name="id4890661"></a><p class="title"><b>Tabel 29.1. PHP en XML-RPC type omzetting</b></p>
<table summary="PHP en XML-RPC type omzetting" border="1">
<colgroup>
<col>
<col>
</colgroup>
<thead><tr>
<th>PHP Native type</th>
<th>XML-RPC type</th>
</tr></thead>
<tbody>
<tr>
<td>integer</td>
<td>int</td>
</tr>
<tr>
<td>double</td>
<td>double</td>
</tr>
<tr>
<td>boolean</td>
<td>boolean</td>
</tr>
<tr>
<td>string</td>
<td>string</td>
</tr>
<tr>
<td>array</td>
<td>array</td>
</tr>
<tr>
<td>associative array</td>
<td>struct</td>
</tr>
<tr>
<td>object</td>
<td>array</td>
</tr>
</tbody>
</table>
</div>
<pre class="programlisting">&lt;?php

/** 2 parameters worden in deze procedure doorgegeven
 *    - De eerste parameter is een string die automatisch zal worden omgezet in een XML-RPC string type
 *    - De tweede parameter is een associatieve array die zal worden omgezet in een XML-RPC struct
 */

$p1 = 'parameter 1';
$p2 = array('name' =&gt; 'Joe', 'age' =&gt; 30);

$service-&gt;serviceProcedure($p1, $p2);

?&gt;
				</pre>
</div>
<div class="sect3" lang="nl">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.xmlrpc.client.parameters.xmlrpc_value"></a>29.2.2.2. <code class="code">Zend_XmlRpc_Value</code> objecten als parameters doorgeven</h4></div></div></div>
<p>
					Je kan één van de volgende <code class="code">Zend_XmlRpc_Value</code> instanties aanmaken om het preciese XML-RPC type
					van je parameters aan te geven.
					De hoofdredenen om expliciet het type van de doorgegeven parameters aan te duiden zijn de volgende:
					</p>
<div class="itemizedlist"><ul type="disc">
<li><p>Wanneer je er zeker van wil zijn dat het juiste parameter type aan de procedure wordt doorgegevn (b.v.: de procedure eist een integer en het is mogelijk dat de parameter via de $_GET array als een string krijgt)</p></li>
<li><p>Indien de procedure een base64 of datetime.iso8601 type vereist (die bestaan niet als PHP-eigen types)</p></li>
<li><p>Als auto-conversie zou kunnen falen (b.v.: je wil een lege XML-RPC struct als parameter doorgeven. Lege structs worden als lege arrays voorgesteld in PHP. Indien je een lege array als parameter doorgeeft zal die
							worden omgezet in een XML-RPC array vermits het geen associatieve array is)</p></li>
</ul></div>
<p>
				</p>
<p>
					Er zijn 2 manieren waarop je een <code class="code">Zend_XmlRpc_Value</code> object kan maken: expliciet (de constructor van het object
					aanroepen) of door de statische functie <code class="code">Zend_XmlRpc_Value::getXmlRpcValue()</code> met de vereiste XML-RPC type constante aan te roepen.
				</p>
<div class="table">
<a name="id4890854"></a><p class="title"><b>Tabel 29.2. <code class="code">Zend_XmlRpc_Value</code> objecten die de XML-RPC types voorstelt</b></p>
<table summary="Zend_XmlRpc_Value objecten die de XML-RPC types voorstelt" border="1">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead><tr>
<th>XML-RPC type</th>
<th>Overeenkomstige <code class="code">Zend_XmlRpc_Value</code> constante</th>
<th>
<code class="code">Zend_XmlRpc_Value</code> object</th>
</tr></thead>
<tbody>
<tr>
<td>int</td>
<td><code class="code">Zend_XmlRpc_Value::XMLRPC_TYPE_INTEGER</code></td>
<td><code class="code">Zend_XmlRpc_Value_Integer</code></td>
</tr>
<tr>
<td>double</td>
<td><code class="code">Zend_XmlRpc_Value::XMLRPC_TYPE_DOUBLE</code></td>
<td><code class="code">Zend_XmlRpc_Value_Double</code></td>
</tr>
<tr>
<td>boolean</td>
<td><code class="code">Zend_XmlRpc_Value::XMLRPC_TYPE_BOOLEAN</code></td>
<td><code class="code">Zend_XmlRpc_Value_Boolean</code></td>
</tr>
<tr>
<td>string</td>
<td><code class="code">Zend_XmlRpc_Value::XMLRPC_TYPE_STRING</code></td>
<td><code class="code">Zend_XmlRpc_Value_String</code></td>
</tr>
<tr>
<td>base64</td>
<td><code class="code">Zend_XmlRpc_Value::XMLRPC_TYPE_BASE64</code></td>
<td><code class="code">Zend_XmlRpc_Value_Base64</code></td>
</tr>
<tr>
<td>dateTime.iso8601</td>
<td><code class="code">Zend_XmlRpc_Value::XMLRPC_TYPE_DATETIME</code></td>
<td><code class="code">Zend_XmlRpc_Value_DateTime</code></td>
</tr>
<tr>
<td>array</td>
<td><code class="code">Zend_XmlRpc_Value::XMLRPC_TYPE_ARRAY</code></td>
<td><code class="code">Zend_XmlRpc_Value_Array</code></td>
</tr>
<tr>
<td>struct</td>
<td><code class="code">Zend_XmlRpc_Value::XMLRPC_TYPE_STRUCT</code></td>
<td><code class="code">Zend_XmlRpc_Value_Struct</code></td>
</tr>
</tbody>
</table>
</div>
<pre class="programlisting">&lt;?php
				
/** 2 parameters worden aan deze procedure doorgegeven
 *    - De eerste parameter is een XML-RPC base64 type dat werd gemaakt door de statische functie Zend_XmlRpc_Value::getXmlRpcValue() aan te roepen
 *    - De tweede parameter is een XML-RPC structuur die expliciet werd gemaakt
 */

$p1 = Zend_XmlRpc_Value::getXmlRpcValue('encoded string', Zend_XmlRpc_Value::XMLRPC_TYPE_BASE64);
$p2 = new Zend_XmlRpc_Value_Struct(array('name' =&gt; 'Joe', 'age' =&gt; 30));

$service-&gt;serviceProcedure($p1, $p2);

?&gt;
				</pre>
<p>
					</p>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Opmerking]" src="images/note.png"></td>
<th align="left">Opmerking</th>
</tr>
<tr><td align="left" valign="top"><p>De waarde van de parameter word nog steeds als een PHP variabele gegeven maar zal worden omgezet naar het gespecifieerde type door de PHP conversietechnieken te gebruiken (b.v.: als een string als waarde aan het <code class="code">Zend_XmlRpc_Value_Integer</code> object wordt gegeven zal het worden omgezet door <code class="code">(int)$value</code>) toe te passen).</p></td></tr>
</table></div>
<p>
				</p>
</div>
<div class="sect3" lang="nl">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.xmlrpc.client.parameters.as_xml"></a>29.2.2.3. Een XML string in een XML-RPC parameter "parsen"</h4></div></div></div>
<p>
					Deze methode van parameters doorgeven word intern in het <code class="code">Zend_XmlRpc</code> pakket gebruikt en word niet aangeraden.
				</p>
<p>
					Indien je toch deze methode moet gebruiken zou je de statische functie <code class="code">Zend_XmlRpc_Value::getXmlRpcValue()</code> moeten gebruiken om een string in een <code class="code">Zend_XmlRpc_Value</code> object te gieten die het overeenkomstige XML-RPC type voorstelt. Je zou 2 parameters aan de <code class="code">Zend_XmlRpc_Value::getXmlRpcValue()</code> functie moeten doorgeven: de XML string en de <code class="code">Zend_XmlRpc_Value::XML_STRING</code> constante.
				</p>
</div>
</div>
<div class="sect2" lang="nl">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.xmlrpc.client.wsdl"></a>29.2.3. Hints geven voor parameter types</h3></div></div></div>
<p>
				Het voornaamste verschil tussen XML-RPC en SOAP web services is het WDSL bestand. Het SOAP protocol heeft meestal een WDSL bestand dat de interface van de web service beschrijft. Aan de hand van deze interface weet de SOAP client welke de benodigde parameter types zijn die naar de server moeten worden gestuurd en wat het type is van de teruggegeven waarde.
				Zonder het WDSL bestand zou de gebruiker een probleem kunnen hebben de types te kennen.
			</p>
<p>
				De oplossing van het XML-RPC protocol is het gebruik van een speciale procedure van de service die <code class="code">system.methodSignature</code> word genoemd. Deze procedure krijgt een procedurenaam als parameter aangegeven en geeft dan de handtekening van de gegeven procedure terug. De handtekening bevat het nodige type van de parameters en de waarde die wordt teruggegeven door de procedure.
			</p>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Opmerking]" src="images/note.png"></td>
<th align="left">Opmerking</th>
</tr>
<tr><td align="left" valign="top"><p>Niet alle XML-RPC server verstaan de speciale <code class="code">system.methodSignature</code> procedure. Servers die dit niet verstaan bieden geen support voor het geven van hints voor types.</p></td></tr>
</table></div>
<p>
				<code class="code">Zend_XmlRpc_Client</code> implementeert een soort van 'WSDL' type bestand voor XML-RPC server die de <code class="code">system.methodSignature</code> procedure gebruiken.
				Indien gevraagd zal <code class="code">Zend_XmlRpc_Client</code> een lijst van alle procedures van een XML-RPC server aanvragen en alle handtekeningen van die procedures en zal die data opslaan in een XML bestand (gelijk aan het SOAP WSDL bestand).
				Als je dan dezelfde XML-RPC server opnieuw gebruikt kan je het XML bestand doorgeven en <code class="code">Zend_XmlRpc_Client</code> zal hints geven voor het type van alle parameters voor de aangevraagde procedure aan de hand van de handtekening ervan.
			</p>
<p>
				Het XML bestand met de procedurehandtekeningen wordt gemaakt door de <code class="code">Zend_XmlRpc_Client::__getMethodsXml()</code> functie aan te roepen. Die geeft een XML string terug die alle data van de handtekening bevat.
				Om een bestaand handtekening XML bestand aan te duiden kan de gebruiker de XML data als parameter aan de contructor van <code class="code">Zend_XmlRpc_Client</code> doorgeven of de <code class="code">Zend_XmlRpc_Client::__setMethodsXml()</code> functie aanroepen.
			</p>
<div class="example">
<a name="id4891354"></a><p class="title"><b>Voorbeeld 29.2. Een XML-RPC service aanroepen met type hints</b></p>
<pre class="programlisting">&lt;?php
				
/**
 * Verbinden met een XML-RPC server, en zijn handtekening bestand opslaan (het equivalent 
 * van een SOAP WSDL bestand)
 */
require_once 'Zend/XmlRpc/Client.php';

$service = new Zend_XmlRpc_Client('http://www.example.org/xmlrpc');

file_put_contents('/tmp/xmlrpc-signatures/example.xml', $service-&gt;__getMethodsXml());

/* Het $service object bevat alle handtekeningen van de XML-RPC server. Wanneer de serviceProcedure word opgeroepen zal zijn parameter ($param) naar het juiste type worden omgezet aan de hand van de handtekening van de procedure.
*/
$service-&gt;serviceProcedure($param);

?&gt;
					</pre>
<pre class="programlisting">&lt;?php

/**
 * Verbinden met een XML-RPC server, gebruik makend van een bestaand handtekeningbestand. Zo verzekeren 
 * we ons ervan dat de doorgegeven parameters van het juiste type zijn.
 */
require_once 'Zend/XmlRpc/Client.php';

$signature_file_xml = file_get_contents('/tmp/xmlrpc-signatures/example.xml');
$service = new Zend_XmlRpc_Client('http://www.example.org/xmlrpc', 'namespace', $signature_file_xml);

/* Het $service object bevat alle handtekeningen van de XML-RPC server. Wanneer de serviceProcedure word opgeroepen zal zijn parameter ($param) naar het juiste type worden omgezet aan de hand van de handtekening van de procedure.
*/
$service-&gt;serviceProcedure($param);

?&gt;
						</pre>
</div>
</div>
<div class="sect2" lang="nl">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.xmlrpc.client.response"></a>29.2.4. Het antwoord terugkrijgen</h3></div></div></div>
<p>
						De XML-RPC procedure geeft een waarde terug met een XML-RPC type.
						De <code class="code">Zend_XmlRpc_Client</code> methode die een XML-RPC procedure aanroept geeft een waarde terug met een PHP-eigen type die werd verkregen vanaf het teruggegeven XML-RPC type.
					</p>
<p>
						Je kan de <code class="code">Zend_XmlRpc_Client::__getResponse()</code> functie gebruiken om de teruggegeven waarde te verkrijgen van de aangevraagde procedure.
						De <code class="code">__getResponse()</code> functie krijgt een parameter die het type van de teruggegeven waarde aanduidt.
						De antwoordopties zijn:
						</p>
<div class="itemizedlist"><ul type="disc">
<li><p><code class="code">Zend_XmlRpc_Client::RESPONSE_PHP_NATIVE</code> - Geef de terugegeven waarde van de procedure als een PHP-eigen waarde terug (zet het XML-RPC type om naar een PHP type).</p></li>
<li><p><code class="code">Zend_XmlRpc_Client::RESPONSE_XML_STRING</code> - Geef de XML string voorstelling van het XML-RPC antwoord terug.</p></li>
<li><p><code class="code">Zend_XmlRpc_Client::RESPONSE_ZXMLRPC_OBJECT</code> - Geef een <code class="code">Zend_XmlRpc_Value</code> object terug die het teruggegeven XML-RPC type voorstelt.</p></li>
</ul></div>
<p>
					</p>
<pre class="programlisting">&lt;?php

$service-&gt;serviceProcedure();

$response = $service-&gt;__getResponse();
// $response is de PHP variabele omgezet van het type van de teruggegeven XML-RPC waarde

$response = $service-&gt;__getResponse(ZXmlRpcClient::RESPONSE_XML_STRING);
// $response is een string die de XML bevat die de door de procedure teruggegeven waarde voorstelt

$response = $service-&gt;__getResponse(ZXmlRpcClient::RESPONSE_ZXMLRPC_OBJECT);
// $response is een Zend_XmlRpc_Value instantie die de door de procedure teruggegeven waarde voorstelt

?&gt;
					</pre>
</div>
</div>
<div class="navfooter"><table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="zend.xmlrpc.html">Terug</a> </td>
<td width="20%" align="center"><a accesskey="u" href="zend.xmlrpc.html">Omhoog</a></td>
<td width="40%" align="right"> <a accesskey="n" href="zend.xmlrpc.server.html">Volgende</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">Hoofdstuk 29. Zend_XmlRpc </td>
<td width="20%" align="center"><a accesskey="h" href="index.html">Begin</a></td>
<td width="40%" align="right" valign="top"> 29.3. Zend_XmlRpc_Server</td>
</tr>
</table></div>
<div class="revinfo"></div>
</body>
</html>
