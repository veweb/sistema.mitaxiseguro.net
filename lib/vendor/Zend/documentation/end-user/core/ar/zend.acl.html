<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>فصل 2. Zend_Acl</title>
<link rel="stylesheet" href="dbstyle.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.69.1">
<link rel="start" href="index.html" title="دليل المبرمج">
<link rel="up" href="index.html" title="دليل المبرمج">
<link rel="prev" href="zend.initregistry.html" title="1.9. (Zend::initRegistry($registry = 'Zend_Registry'">
<link rel="next" href="zend.acl.refining.html" title="2.2. Refining Access Controls">
<link rel="chapter" href="zend.html" title="فصل 1. Zend">
<link rel="chapter" href="zend.acl.html" title="فصل 2. Zend_Acl">
<link rel="chapter" href="zend.auth.html" title="فصل 3. Zend_Auth">
<link rel="chapter" href="zend.cache.html" title="فصل 4. Zend_Cache">
<link rel="chapter" href="zend.config.html" title="فصل 5. Zend_Config">
<link rel="chapter" href="zend.console.getopt.html" title="فصل 6. Zend_Console_Getopt">
<link rel="chapter" href="zend.controller.html" title="فصل 7. Zend_Controller">
<link rel="chapter" href="zend.date.html" title="فصل 8. Zend_Date">
<link rel="chapter" href="zend.db.html" title="فصل 9. Zend_Db">
<link rel="chapter" href="zend.feed.html" title="فصل 10. Zend_Feed">
<link rel="chapter" href="zend.filter.html" title="فصل 11. Zend_Filter">
<link rel="chapter" href="zend.gdata.html" title="فصل 12. Zend_Gdata">
<link rel="chapter" href="zend.http.html" title="فصل 13. Zend_Http">
<link rel="chapter" href="zend.json.html" title="فصل 14. Zend_Json">
<link rel="chapter" href="zend.locale.html" title="فصل 15. Zend_Locale">
<link rel="chapter" href="zend.log.html" title="فصل 16. Zend_Log">
<link rel="chapter" href="zend.mail.html" title="فصل 17. Zend_Mail">
<link rel="chapter" href="zend.measure.html" title="فصل 18. Zend_Measure">
<link rel="chapter" href="zend.mime.html" title="فصل 19. Zend_Mime">
<link rel="chapter" href="zend.pdf.html" title="فصل 20. Zend_Pdf">
<link rel="chapter" href="zend.rest.html" title="فصل 21. Zend_Rest">
<link rel="chapter" href="zend.search.html" title="فصل 22. Zend_Search">
<link rel="chapter" href="zend.server.html" title="فصل 23. Zend_Server">
<link rel="chapter" href="zend.service.html" title="فصل 24. Zend_Service">
<link rel="chapter" href="zend.session.html" title="فصل 25. Zend_Session">
<link rel="chapter" href="zend.uri.html" title="فصل 26. Zend_Uri">
<link rel="chapter" href="zend.validate.html" title="فصل 27. Zend_Validate">
<link rel="chapter" href="zend.view.html" title="فصل 28. Zend_View">
<link rel="chapter" href="zend.xmlrpc.html" title="فصل 29. Zend_XmlRpc">
<link rel="appendix" href="coding-standard.html" title="ملحق A. Zend Framework PHP Coding Standard">
<link rel="appendix" href="copyrights.html" title="ملحق B. معلومات حقوق الملكية">
<link rel="index" href="the.index.html" title="فهرس">
<link rel="section" href="zend.acl.html#zend.acl.introduction" title="2.1. Introduction">
<link rel="section" href="zend.acl.refining.html" title="2.2. Refining Access Controls">
<link rel="section" href="zend.acl.advanced.html" title="2.3. Advanced Use">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader"><table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">فصل 2. Zend_Acl</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="zend.initregistry.html">السابق</a> </td>
<th width="60%" align="center"> </th>
<td width="20%" align="right"> <a accesskey="n" href="zend.acl.refining.html">التالي</a>
</td>
</tr>
</table></div>
<div class="chapter" lang="ar">
<div class="titlepage"><div><div><h2 class="title">
<a name="zend.acl"></a>فصل 2. Zend_Acl</h2></div></div></div>
<div class="toc">
<p><b>قائمة المحتويات</b></p>
<dl>
<dt><span class="sect1"><a href="zend.acl.html#zend.acl.introduction">2.1. Introduction</a></span></dt>
<dd><dl>
<dt><span class="sect2"><a href="zend.acl.html#zend.acl.introduction.resources">2.1.1. About Resources</a></span></dt>
<dt><span class="sect2"><a href="zend.acl.html#zend.acl.introduction.roles">2.1.2. About Roles</a></span></dt>
<dt><span class="sect2"><a href="zend.acl.html#zend.acl.introduction.creating">2.1.3. Creating the Access Control List (ACL)</a></span></dt>
<dt><span class="sect2"><a href="zend.acl.html#zend.acl.introduction.role_registry">2.1.4. Registering Roles</a></span></dt>
<dt><span class="sect2"><a href="zend.acl.html#zend.acl.introduction.defining">2.1.5. Defining Access Controls</a></span></dt>
<dt><span class="sect2"><a href="zend.acl.html#zend.acl.introduction.querying">2.1.6. Querying the ACL</a></span></dt>
</dl></dd>
<dt><span class="sect1"><a href="zend.acl.refining.html">2.2. Refining Access Controls</a></span></dt>
<dd><dl>
<dt><span class="sect2"><a href="zend.acl.refining.html#zend.acl.refining.precise">2.2.1. Precise Access Controls</a></span></dt>
<dt><span class="sect2"><a href="zend.acl.refining.html#zend.acl.refining.removing">2.2.2. Removing Access Controls</a></span></dt>
</dl></dd>
<dt><span class="sect1"><a href="zend.acl.advanced.html">2.3. Advanced Use</a></span></dt>
<dd><dl>
<dt><span class="sect2"><a href="zend.acl.advanced.html#zend.acl.advanced.storing">2.3.1. Storing ACL Data for Persistence</a></span></dt>
<dt><span class="sect2"><a href="zend.acl.advanced.html#zend.acl.advanced.assertions">2.3.2. Writing Conditional ACL Rules with Assertions</a></span></dt>
</dl></dd>
</dl>
</div>
<div class="sect1" lang="ar">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="zend.acl.introduction"></a>2.1. Introduction</h2></div></div></div>
<p>
        Zend_Acl provides lightweight and flexible access control list (ACL) functionality
        and privileges management. In general, an application may utilize such functionality
        to control access to certain protected objects by other requesting objects.
    </p>
<p>
        For the purposes of this documentation,

        </p>
<div class="itemizedlist"><ul type="disc">
<li><p>
                    a <span class="strong"><strong>Resource</strong></span> is an object
                    to which access is controlled.
                </p></li>
<li><p>
                    a <span class="strong"><strong>Role</strong></span> is an object
                    that may request access to a Resource.
                </p></li>
</ul></div>
<p>

        Put simply, <span class="strong"><strong>Roles request access to Resources</strong></span>.
        For example, if a person requests access to a car, then the person is the requesting Role,
        and the car is the Resource, since access to the car is under control.
    </p>
<p>
        Through the specification and use of an access control list (ACL), an application may control
        how requesting objects (Roles) are granted access to protected objects (Resources).
    </p>
<div class="sect2" lang="ar">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.acl.introduction.resources"></a>2.1.1. About Resources</h3></div></div></div>
<p>
            In Zend_Acl, creating a Resource is very simple. Zend_Acl provides
            <code class="code">Zend_Acl_Resource_Interface</code> to facilitate developers' creating Resources. A class need only
            implement this interface, which consists of a single method, <code class="code">getResourceId()</code>, in order
            for Zend_Acl to consider the object to be a Resource. Additionally, <code class="code">Zend_Acl_Resource</code> is
            included with Zend_Acl as a basic Resource implementation for developers to extend where desirable.
        </p>
<p>
            Zend_Acl provides a tree structure to which multiple Resources (or "areas under access control")
            can be added. Since Resources are stored in such a tree structure, they can be organized from the
            general (toward the tree root) to the specific (toward the tree leaves). Queries upon
            a specific Resource will automatically search the Resource's hierarchy for rules assigned to ancestor
            Resources, allowing for simple inheritance of rules. For example, if a default rule is to be
            applied to each building in a city, one would simply assign the rule to the city, instead of
            assigning the same rule to each building. Some buildings may require exceptions to such a
            rule, however, and this is achieved easily in Zend_Acl by assigning such exception rules to
            each such building that requires an exception to the rule. a Resource may inherit from only one
            parent Resource, though this parent Resource can have its own parent Resource, and so on.
        </p>
<p>
            Zend_Acl also supports privileges upon Resources (e.g., "create", "read", "update", "delete"), and
            the developer can assign rules that affect all privileges or specific privileges upon a Resource.
        </p>
</div>
<div class="sect2" lang="ar">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.acl.introduction.roles"></a>2.1.2. About Roles</h3></div></div></div>
<p>
            Like with Resources, creating a Role is also very simple. Zend_Acl provides
            <code class="code">Zend_Acl_Role_Interface</code> to facilitate developers' creating Roles. A class need only
            implement this interface, which consists of a single method, <code class="code">getRoleId()</code>, in order
            for Zend_Acl to consider the object to be a Role. Additionally, <code class="code">Zend_Acl_Role</code> is
            included with Zend_Acl as a basic Role implementation for developers to extend where desirable.
        </p>
<p>
            In Zend_Acl, a Role may inherit from one or more Roles. This is to support inheritance of rules
            among Roles. For example, a user Role, such as "sally", may belong to one or more role Roles,
            such as "editor" and "administrator". The developer can assign rules to "editor" and
            "administrator" separately, and "sally" would inherit such rules from both, without having to
            assign rules directly to "sally".
        </p>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[ملاحظة]" src="images/note.png"></td>
<th align="left">ملاحظة</th>
</tr>
<tr><td align="left" valign="top"><p>
                Since Zend_Acl supports inheriting rules from multiple Roles, which may possibly
                conflict with each other, a way to unambiguously resolve such conflicts is necessary. Zend_Acl
                resolves such potential conflicts by considering the most recently inherited Role as highest
                priority. That is, once a rule is found for a "parent" Role, starting at the most recently
                inherited Role, no other rules are considered, since the highest priority rule has already been
                reached.
            </p></td></tr>
</table></div>
</div>
<div class="sect2" lang="ar">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.acl.introduction.creating"></a>2.1.3. Creating the Access Control List (ACL)</h3></div></div></div>
<p>
            An ACL can represent any set of physical or virtual objects that you wish.
            For the purposes of demonstration, however, we will create a basic Content Management System ACL
            that maintains several tiers of groups over a wide variety of areas. To create a new ACL object,
            we instantiate the ACL with no parameters:
        </p>
<pre class="programlisting">&lt;?php
require_once 'Zend/Acl.php';

$acl = new Zend_Acl();</pre>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[ملاحظة]" src="images/note.png"></td>
<th align="left">ملاحظة</th>
</tr>
<tr><td align="left" valign="top"><p>
                Zend_Acl is a "whitelist" implementation by default, which means that unless otherwise
                specified by the developer, Zend_Acl denies access to every privilege upon every Resource by
                every Role.
            </p></td></tr>
</table></div>
</div>
<div class="sect2" lang="ar">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.acl.introduction.role_registry"></a>2.1.4. Registering Roles</h3></div></div></div>
<p>
            Content Management Systems will nearly always require a hierarchy of permissions
            to determine the authoring capabilities of its users. There may be a 'Guest' group to
            allow limited access for demonstrations, a 'Staff' group for the majority of CMS users
            who perform most of the day-to-day operations, an 'Editor' group for those responsible for publishing,
            reviewing, archiving and deleting content, and finally an 'Administrator' group whose tasks may
            include all of those of the other groups as well as maintenance of sensitive information,
            user management, back-end configuration data and backup/export. This set of permissions can be
            represented in a Role registry, allowing each group to inherit privileges from 'parent' groups,
            as well as providing distinct privileges for their unique group only.
            The permissions may be expressed as follows:
        </p>
<div class="table">
<a name="id4733219"></a><p class="title"><b>جدول 2.1. Access Controls for an Example CMS</b></p>
<table summary="Access Controls for an Example CMS" border="1">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead><tr>
<th>Name</th>
<th>Unique permissions</th>
<th>Inherit permissions from</th>
</tr></thead>
<tbody>
<tr>
<td>Guest</td>
<td>View</td>
<td>N/A</td>
</tr>
<tr>
<td>Staff</td>
<td>Edit, Submit, Revise</td>
<td>Guest</td>
</tr>
<tr>
<td>Editor</td>
<td>Publish, Archive, Delete</td>
<td>Staff</td>
</tr>
<tr>
<td>Administrator</td>
<td>(Granted all access)</td>
<td>N/A</td>
</tr>
</tbody>
</table>
</div>
<p>
            For this example, <code class="code">Zend_Acl_Role</code> is used, but any object that implements
            <code class="code">Zend_Acl_Role_Interface</code> is acceptable. These groups can be added to the
            Role registry as follows:
        </p>
<pre class="programlisting">&lt;?php
require_once 'Zend/Acl.php';

$acl = new Zend_Acl();

// Add groups to the Role registry using Zend_Acl_Role
require_once 'Zend/Acl/Role.php';

// Guest does not inherit access controls
$roleGuest = new Zend_Acl_Role('guest');
$acl-&gt;addRole($roleGuest);

// Staff inherits from guest
$acl-&gt;addRole(new Zend_Acl_Role('staff'), $roleGuest);

/* alternatively, the above could be written:
$roleGuest = $acl-&gt;addRole(new Zend_Acl_Role('staff'), 'guest');
//*/

// Editor inherits from staff
$acl-&gt;addRole(new Zend_Acl_Role('editor'), 'staff');

// Administrator does not inherit access controls
$acl-&gt;addRole(new Zend_Acl_Role('administrator'));</pre>
</div>
<div class="sect2" lang="ar">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.acl.introduction.defining"></a>2.1.5. Defining Access Controls</h3></div></div></div>
<p>
            Now that the ACL contains the relevant Roles, rules can be established that define how
            Resources may be accessed by Roles. You may have noticed that we have not defined any particular
            Resources for this example, which is simplified to illustrate that the rules apply to all Resources.
            Zend_Acl provides an implementation whereby rules need only be assigned from general to specific,
            minimizing the number of rules needed, because Resources and Roles inherit rules that are defined upon
            their ancestors.
        </p>
<p>
            Consequently, we can define a reasonably complex set of rules with a minimum amount of code.
            To apply the base permissions as defined above:
        </p>
<pre class="programlisting">&lt;?php
require_once 'Zend/Acl.php';

$acl = new Zend_Acl();

require_once 'Zend/Acl/Role.php';

$roleGuest = new Zend_Acl_Role('guest');
$acl-&gt;addRole($roleGuest);
$acl-&gt;addRole(new Zend_Acl_Role('staff'), $roleGuest);
$acl-&gt;addRole(new Zend_Acl_Role('editor'), 'staff');
$acl-&gt;addRole(new Zend_Acl_Role('administrator'));

// Guest may only view content
$acl-&gt;allow($roleGuest, null, 'view');

/* alternatively, the above could be written:
$acl-&gt;allow('guest', null, 'view');
//*/

// Staff inherits view privilege from guest, but also needs additional privileges
$acl-&gt;allow('staff', null, array('edit', 'submit', 'revise'));

// Editor inherits view, edit, submit, and revise privileges from staff,
// but also needs additional privileges
$acl-&gt;allow('editor', null, array('publish', 'archive', 'delete'));

// Administrator inherits nothing, but is allowed all privileges
$acl-&gt;allow('administrator');</pre>
<p>
            The <code class="code">null</code> values in the above <code class="code">allow()</code> calls are used to indicate
            that the allow rules apply to all Resources.
        </p>
</div>
<div class="sect2" lang="ar">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.acl.introduction.querying"></a>2.1.6. Querying the ACL</h3></div></div></div>
<p>
            We now have a flexible ACL that can be used to determine whether requesters have permission
            to perform functions throughout the web application. Performing queries is quite simple using
            the <code class="code">isAllowed()</code> method:
        </p>
<pre class="programlisting">&lt;?php
echo $acl-&gt;isAllowed('guest', null, 'view') ?
     "allowed" : "denied"; // allowed

echo $acl-&gt;isAllowed('staff', null, 'publish') ?
     "allowed" : "denied"; // denied

echo $acl-&gt;isAllowed('staff', null, 'revise') ?
     "allowed" : "denied"; // allowed

echo $acl-&gt;isAllowed('editor', null, 'view') ?
     "allowed" : "denied"; // allowed because of inheritance from guest

echo $acl-&gt;isAllowed('editor', null, 'update') ?
     "allowed" : "denied"; // denied because no allow rule for 'update'

echo $acl-&gt;isAllowed('administrator', null, 'view') ?
     "allowed" : "denied"; // allowed because administrator is allowed all privileges

echo $acl-&gt;isAllowed('administrator') ?
     "allowed" : "denied"; // allowed because administrator is allowed all privileges

echo $acl-&gt;isAllowed('administrator', null, 'update') ?
     "allowed" : "denied"; // allowed because administrator is allowed all privileges</pre>
</div>
</div>
</div>
<div class="navfooter"><table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="zend.initregistry.html">السابق</a> </td>
<td width="20%" align="center"> </td>
<td width="40%" align="right"> <a accesskey="n" href="zend.acl.refining.html">التالي</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">1.9. (Zend::initRegistry($registry = 'Zend_Registry' </td>
<td width="20%" align="center"><a accesskey="h" href="index.html">البداية</a></td>
<td width="40%" align="right" valign="top"> 2.2. Refining Access Controls</td>
</tr>
</table></div>
<div class="revinfo"></div>
</body>
</html>
